{
  "version": 3,
  "sources": ["../src/game/constants.ts", "../src/game/game.ts", "../src/game/beatmap.ts", "../src/browser/audio.ts", "../src/browser/input.ts", "../src/browser/renderer.ts", "../src/browser/main.ts"],
  "sourcesContent": ["// Timing\nexport const APPROACH_TIME = 1.2;       // seconds \u2014 time from target spawn to beat\nexport const PERFECT_WINDOW = 0.1;      // \u00B1100ms for perfect hit\nexport const GOOD_WINDOW = 0.25;        // \u00B1250ms for good hit\n\n// Sizes (normalized 0-1 screen space)\nexport const HIT_RADIUS = 0.08;         // cursor must be within this distance of target\nexport const CURSOR_RADIUS = 0.03;      // cursor collision radius\nexport const PROJECTILE_RADIUS = 0.02;  // projectile collision radius\n\n// Scoring\nexport const PERFECT_SCORE = 300;\nexport const GOOD_SCORE = 100;\nexport const COMBO_MILESTONE = 10;      // combo milestone every N hits\nexport const MAX_MULTIPLIER = 8;\n\n// Health\nexport const MAX_HEALTH = 100;\nexport const MISS_DAMAGE = 3;\nexport const PROJECTILE_DAMAGE = 8;\nexport const PERFECT_HEAL = 1;\n\n// Effects\nexport const HIT_EFFECT_DURATION = 0.6;\nexport const MISS_EFFECT_DURATION = 0.5;\nexport const DAMAGE_EFFECT_DURATION = 0.4;\nexport const COMBO_EFFECT_DURATION = 0.8;\n\n// Countdown\nexport const COUNTDOWN_SECONDS = 3;\n", "import type {\n  ActiveProjectile,\n  ActiveTarget,\n  AudioPlayer,\n  Beatmap,\n  Effect,\n  GamePhase,\n  HitCounts,\n  Vec2,\n} from \"./types.ts\";\n\nimport {\n  APPROACH_TIME,\n  COMBO_EFFECT_DURATION,\n  COMBO_MILESTONE,\n  COUNTDOWN_SECONDS,\n  CURSOR_RADIUS,\n  DAMAGE_EFFECT_DURATION,\n  GOOD_SCORE,\n  GOOD_WINDOW,\n  HIT_EFFECT_DURATION,\n  HIT_RADIUS,\n  MAX_HEALTH,\n  MAX_MULTIPLIER,\n  MISS_DAMAGE,\n  MISS_EFFECT_DURATION,\n  PERFECT_HEAL,\n  PERFECT_SCORE,\n  PERFECT_WINDOW,\n  PROJECTILE_DAMAGE,\n  PROJECTILE_RADIUS,\n} from \"./constants.ts\";\n\nexport class Game {\n  beatmap: Beatmap;\n  phase: GamePhase = \"menu\";\n  time = 0;\n  score = 0;\n  combo = 0;\n  maxCombo = 0;\n  health = MAX_HEALTH;\n  targets: ActiveTarget[] = [];\n  projectiles: ActiveProjectile[] = [];\n  effects: Effect[] = [];\n  nextEvent = 0;\n  hits: HitCounts = { perfect: 0, good: 0, miss: 0 };\n  countdownValue = COUNTDOWN_SECONDS;\n\n  private _countdownStart = 0;\n  private _playStart = 0;\n  private _lastComboMilestone = 0;\n\n  constructor(beatmap: Beatmap) {\n    this.beatmap = beatmap;\n  }\n\n  start(now: number): void {\n    this.phase = \"countdown\";\n    this.time = 0;\n    this.score = 0;\n    this.combo = 0;\n    this.maxCombo = 0;\n    this.health = MAX_HEALTH;\n    this.targets = [];\n    this.projectiles = [];\n    this.effects = [];\n    this.nextEvent = 0;\n    this.hits = { perfect: 0, good: 0, miss: 0 };\n    this.countdownValue = COUNTDOWN_SECONDS;\n    this._countdownStart = now;\n    this._playStart = 0;\n    this._lastComboMilestone = 0;\n  }\n\n  update(now: number, dt: number, cursor: Vec2, audio: AudioPlayer): void {\n    if (this.phase === \"countdown\") {\n      this._updateCountdown(now);\n      return;\n    }\n\n    if (this.phase !== \"playing\") return;\n\n    this.time = now - this._playStart;\n\n    this._spawnEvents(audio);\n    this._updateTargets(cursor, audio);\n    this._updateProjectiles(dt, cursor, audio);\n    this._updateEffects(dt);\n\n    this.health = Math.max(0, Math.min(MAX_HEALTH, this.health));\n\n    if (this.health <= 0) {\n      this.phase = \"gameover\";\n      return;\n    }\n\n    if (this.time >= this.beatmap.duration) {\n      this.phase = \"results\";\n    }\n  }\n\n  /** Advance game time directly (for testing without real clock) */\n  tick(dt: number, cursor: Vec2, audio: AudioPlayer): void {\n    if (this.phase === \"countdown\") {\n      this.countdownValue -= dt;\n      if (this.countdownValue <= 0) {\n        this.phase = \"playing\";\n        this.time = 0;\n      }\n      return;\n    }\n\n    if (this.phase !== \"playing\") return;\n\n    this.time += dt;\n\n    this._spawnEvents(audio);\n    this._updateTargets(cursor, audio);\n    this._updateProjectiles(dt, cursor, audio);\n    this._updateEffects(dt);\n\n    this.health = Math.max(0, Math.min(MAX_HEALTH, this.health));\n\n    if (this.health <= 0) {\n      this.phase = \"gameover\";\n      return;\n    }\n\n    if (this.time >= this.beatmap.duration) {\n      this.phase = \"results\";\n    }\n  }\n\n  // ---- Private ----\n\n  private _updateCountdown(now: number): void {\n    const elapsed = now - this._countdownStart;\n    this.countdownValue = COUNTDOWN_SECONDS - elapsed;\n    if (elapsed >= COUNTDOWN_SECONDS) {\n      this.phase = \"playing\";\n      this._playStart = now;\n      this.time = 0;\n    }\n  }\n\n  private _spawnEvents(audio: AudioPlayer): void {\n    while (this.nextEvent < this.beatmap.events.length) {\n      const event = this.beatmap.events[this.nextEvent];\n      const spawnTime = event.type === \"target\"\n        ? event.time - APPROACH_TIME\n        : event.time;\n\n      if (spawnTime <= this.time) {\n        if (event.type === \"target\") {\n          this.targets.push({\n            x: event.x,\n            y: event.y,\n            time: event.time,\n            hit: false,\n            missed: false,\n          });\n          audio.playTick();\n        } else {\n          this.projectiles.push({\n            x: event.x,\n            y: event.y,\n            dx: event.dx,\n            dy: event.dy,\n            speed: event.speed,\n          });\n        }\n        this.nextEvent++;\n      } else {\n        break;\n      }\n    }\n  }\n\n  private _updateTargets(cursor: Vec2, audio: AudioPlayer): void {\n    for (let i = this.targets.length - 1; i >= 0; i--) {\n      const target = this.targets[i];\n      const timeDiff = this.time - target.time;\n\n      // Check hit\n      if (!target.hit && !target.missed && Math.abs(timeDiff) <= GOOD_WINDOW) {\n        const dx = cursor.x - target.x;\n        const dy = cursor.y - target.y;\n        const dist = Math.sqrt(dx * dx + dy * dy);\n\n        if (dist < HIT_RADIUS) {\n          target.hit = true;\n          const isPerfect = Math.abs(timeDiff) <= PERFECT_WINDOW;\n          this._registerHit(isPerfect, target, audio);\n        }\n      }\n\n      // Miss\n      if (!target.hit && !target.missed && timeDiff > GOOD_WINDOW) {\n        target.missed = true;\n        this._registerMiss(target, audio);\n      }\n\n      // Cleanup old targets\n      if (timeDiff > GOOD_WINDOW + 0.8) {\n        this.targets.splice(i, 1);\n      }\n    }\n  }\n\n  private _updateProjectiles(\n    dt: number,\n    cursor: Vec2,\n    audio: AudioPlayer,\n  ): void {\n    for (let i = this.projectiles.length - 1; i >= 0; i--) {\n      const p = this.projectiles[i];\n      p.x += p.dx * p.speed * dt;\n      p.y += p.dy * p.speed * dt;\n\n      // Collision with cursor\n      const dx = cursor.x - p.x;\n      const dy = cursor.y - p.y;\n      const dist = Math.sqrt(dx * dx + dy * dy);\n\n      if (dist < PROJECTILE_RADIUS + CURSOR_RADIUS) {\n        this.health -= PROJECTILE_DAMAGE;\n        this.combo = 0;\n        this._lastComboMilestone = 0;\n        audio.playDamage();\n        this.effects.push({\n          type: \"damage\",\n          x: p.x,\n          y: p.y,\n          life: DAMAGE_EFFECT_DURATION,\n          maxLife: DAMAGE_EFFECT_DURATION,\n        });\n        this.projectiles.splice(i, 1);\n        continue;\n      }\n\n      // Off screen\n      if (p.x < -0.15 || p.x > 1.15 || p.y < -0.15 || p.y > 1.15) {\n        this.projectiles.splice(i, 1);\n      }\n    }\n  }\n\n  private _updateEffects(dt: number): void {\n    for (let i = this.effects.length - 1; i >= 0; i--) {\n      this.effects[i].life -= dt;\n      if (this.effects[i].life <= 0) {\n        this.effects.splice(i, 1);\n      }\n    }\n  }\n\n  private _registerHit(\n    isPerfect: boolean,\n    target: ActiveTarget,\n    audio: AudioPlayer,\n  ): void {\n    this.combo++;\n    if (this.combo > this.maxCombo) this.maxCombo = this.combo;\n\n    const multiplier = Math.min(\n      Math.floor(this.combo / COMBO_MILESTONE) + 1,\n      MAX_MULTIPLIER,\n    );\n    const baseScore = isPerfect ? PERFECT_SCORE : GOOD_SCORE;\n    this.score += baseScore * multiplier;\n\n    if (isPerfect) {\n      this.hits.perfect++;\n      audio.playHit(1.0);\n      this.health = Math.min(MAX_HEALTH, this.health + PERFECT_HEAL);\n    } else {\n      this.hits.good++;\n      audio.playHit(0.6);\n    }\n\n    // Combo milestone\n    const milestone =\n      Math.floor(this.combo / COMBO_MILESTONE) * COMBO_MILESTONE;\n    if (milestone > 0 && milestone > this._lastComboMilestone) {\n      this._lastComboMilestone = milestone;\n      audio.playCombo();\n      this.effects.push({\n        type: \"combo_milestone\",\n        x: 0.5,\n        y: 0.5,\n        life: COMBO_EFFECT_DURATION,\n        maxLife: COMBO_EFFECT_DURATION,\n        value: milestone,\n      });\n    }\n\n    this.effects.push({\n      type: isPerfect ? \"perfect\" : \"good\",\n      x: target.x,\n      y: target.y,\n      life: HIT_EFFECT_DURATION,\n      maxLife: HIT_EFFECT_DURATION,\n    });\n  }\n\n  private _registerMiss(target: ActiveTarget, audio: AudioPlayer): void {\n    this.hits.miss++;\n    this.combo = 0;\n    this._lastComboMilestone = 0;\n    this.health -= MISS_DAMAGE;\n    audio.playMiss();\n    this.effects.push({\n      type: \"miss\",\n      x: target.x,\n      y: target.y,\n      life: MISS_EFFECT_DURATION,\n      maxLife: MISS_EFFECT_DURATION,\n    });\n  }\n}\n", "import type { Beatmap, BeatmapEvent, ProjectileEvent } from \"./types.ts\";\n\nfunction clamp(v: number, min: number, max: number): number {\n  return Math.max(min, Math.min(max, v));\n}\n\n/** Generate a projectile that spawns at the tunnel center (0.5, 0.5) and flies outward. */\nfunction randomTunnelProjectile(time: number, progress: number): ProjectileEvent {\n  // Random outward direction from center\n  const angle = Math.random() * Math.PI * 2;\n  let dx = Math.cos(angle);\n  let dy = Math.sin(angle);\n\n  // Normalize (already unit length from cos/sin, but be explicit)\n  const len = Math.sqrt(dx * dx + dy * dy);\n  dx /= len;\n  dy /= len;\n\n  return {\n    time,\n    type: \"projectile\",\n    x: 0.5,\n    y: 0.5,\n    dx,\n    dy,\n    speed: 0.25 + progress * 0.35,\n  };\n}\n\nexport function generateBeatmap(bpm = 140, duration = 60): Beatmap {\n  const events: BeatmapEvent[] = [];\n  const beatInterval = 60 / bpm;\n\n  let time = 3;\n  let lastX = 0.5;\n  let lastY = 0.5;\n  let side = 0;\n\n  while (time < duration - 5) {\n    const progress = time / duration;\n\n    // Interval decreases with progression\n    const interval =\n      progress < 0.2 ? beatInterval * 2 :\n      progress < 0.5 ? beatInterval :\n      progress < 0.8 ? beatInterval * 0.75 :\n      beatInterval * 0.5;\n\n    // Max distance between consecutive targets (ensures reachability)\n    const maxDist = Math.min(interval * 0.6, 0.4);\n\n    let tx: number, ty: number;\n\n    if (Math.random() < 0.3) {\n      // Random within reach of last position\n      tx = lastX + (Math.random() - 0.5) * maxDist * 2;\n      ty = lastY + (Math.random() - 0.5) * maxDist * 2;\n    } else {\n      // Alternate left/right for rhythm feel\n      tx = side === 0\n        ? 0.2 + Math.random() * 0.25\n        : 0.55 + Math.random() * 0.25;\n      ty = 0.2 + Math.random() * 0.6;\n      side = 1 - side;\n\n      // Constrain if too far from last position\n      const ddx = tx - lastX;\n      const ddy = ty - lastY;\n      const dist = Math.sqrt(ddx * ddx + ddy * ddy);\n      if (dist > maxDist * 1.5) {\n        tx = lastX + (ddx / dist) * maxDist * 1.2;\n        ty = lastY + (ddy / dist) * maxDist * 1.2;\n      }\n    }\n\n    tx = clamp(tx, 0.1, 0.9);\n    ty = clamp(ty, 0.1, 0.9);\n\n    events.push({ time, type: \"target\", x: tx, y: ty });\n    lastX = tx;\n    lastY = ty;\n\n    // Projectiles after 35% progress, increasing frequency\n    if (progress > 0.35 && Math.random() < (progress - 0.3) * 0.5) {\n      events.push(randomTunnelProjectile(time + beatInterval * 0.5, progress));\n    }\n\n    // Extra projectile wave in intense sections\n    if (progress > 0.7 && Math.random() < 0.3) {\n      events.push(randomTunnelProjectile(time + beatInterval * 0.25, progress));\n    }\n\n    time += interval;\n  }\n\n  events.sort((a, b) => a.time - b.time);\n  return { bpm, duration, events };\n}\n", "import type { AudioPlayer } from \"../game/types.ts\";\n\nexport class AudioManager implements AudioPlayer {\n  private ctx: AudioContext | null = null;\n  private musicSource: AudioBufferSourceNode | null = null;\n  private musicGain: GainNode | null = null;\n  private musicStartTime = 0;\n  private musicBuffer: AudioBuffer | null = null;\n  private musicRawData: ArrayBuffer | null = null;\n  private _musicMuted = false;\n  private _musicVolume = 0.5;\n\n  async init(): Promise<void> {\n    this.ctx = new (\n      (window as unknown as Record<string, typeof AudioContext>).AudioContext ||\n      (window as unknown as Record<string, typeof AudioContext>).webkitAudioContext\n    )();\n    await this.ctx.resume();\n\n    // If raw MP3 data was fetched before init, decode it now\n    if (this.musicRawData && !this.musicBuffer) {\n      this.musicBuffer = await this.ctx.decodeAudioData(this.musicRawData);\n      this.musicRawData = null;\n    }\n  }\n\n  /** Fetch an MP3 file for later playback. Can be called before init(). */\n  async loadMusic(url: string): Promise<void> {\n    const resp = await fetch(url);\n    const arrayBuf = await resp.arrayBuffer();\n\n    if (this.ctx) {\n      // AudioContext ready \u2014 decode immediately\n      this.musicBuffer = await this.ctx.decodeAudioData(arrayBuf);\n    } else {\n      // Store raw bytes; will be decoded when init() is called\n      this.musicRawData = arrayBuf;\n    }\n  }\n\n  /** Start playing loaded music. Returns the AudioContext time at which it started. */\n  startMusic(): number {\n    if (!this.ctx || !this.musicBuffer) return 0;\n    this.stopMusic();\n\n    this.musicGain = this.ctx.createGain();\n    this.musicGain.gain.value = 0.5;\n    this.musicGain.connect(this.ctx.destination);\n\n    this.musicSource = this.ctx.createBufferSource();\n    this.musicSource.buffer = this.musicBuffer;\n    this.musicSource.connect(this.musicGain);\n    this.musicSource.start();\n    this.musicStartTime = this.ctx.currentTime;\n    return this.musicStartTime;\n  }\n\n  /** Get current music playback time in seconds. */\n  getMusicTime(): number {\n    if (!this.ctx || !this.musicStartTime) return 0;\n    return this.ctx.currentTime - this.musicStartTime;\n  }\n\n  /** Stop music playback. */\n  stopMusic(): void {\n    if (this.musicSource) {\n      try { this.musicSource.stop(); } catch { /* already stopped */ }\n      this.musicSource = null;\n    }\n    this.musicStartTime = 0;\n  }\n\n  /** Toggle music mute state. Returns the new muted state. */\n  toggleMusicMute(): boolean {\n    this._musicMuted = !this._musicMuted;\n    if (this.musicGain) {\n      this.musicGain.gain.value = this._musicMuted ? 0 : this._musicVolume;\n    }\n    return this._musicMuted;\n  }\n\n  /** Whether music is currently muted. */\n  get musicMuted(): boolean {\n    return this._musicMuted;\n  }\n\n  private _play(setup: (t: number, ctx: AudioContext) => void): void {\n    if (!this.ctx) return;\n    try {\n      setup(this.ctx.currentTime, this.ctx);\n    } catch {\n      // Silently ignore audio errors (e.g. too many nodes)\n    }\n  }\n\n  // --- Cyberpunk / deep sound effects ---\n\n  /** Sub-bass thump when target spawns (replaces chirpy 600Hz sine). */\n  playTick(): void {\n    this._play((t, ctx) => {\n      // Sub-bass thump: 150 \u2192 60 Hz\n      const osc = ctx.createOscillator();\n      const gain = ctx.createGain();\n      osc.type = \"sine\";\n      osc.frequency.setValueAtTime(150, t);\n      osc.frequency.exponentialRampToValueAtTime(60, t + 0.08);\n      gain.gain.setValueAtTime(0.15, t);\n      gain.gain.exponentialRampToValueAtTime(0.001, t + 0.08);\n      osc.connect(gain).connect(ctx.destination);\n      osc.start(t);\n      osc.stop(t + 0.09);\n\n      // Short noise burst for attack transient\n      const bufSize = ctx.sampleRate * 0.02;\n      const noiseBuf = ctx.createBuffer(1, bufSize, ctx.sampleRate);\n      const data = noiseBuf.getChannelData(0);\n      for (let i = 0; i < bufSize; i++) data[i] = (Math.random() * 2 - 1) * 0.3;\n      const noise = ctx.createBufferSource();\n      noise.buffer = noiseBuf;\n      const noiseGain = ctx.createGain();\n      noiseGain.gain.setValueAtTime(0.06, t);\n      noiseGain.gain.exponentialRampToValueAtTime(0.001, t + 0.02);\n      // Low-pass to keep it dark\n      const lp = ctx.createBiquadFilter();\n      lp.type = \"lowpass\";\n      lp.frequency.value = 400;\n      noise.connect(lp).connect(noiseGain).connect(ctx.destination);\n      noise.start(t);\n      noise.stop(t + 0.03);\n    });\n  }\n\n  /** Deep impact on hit (replaces 660-880Hz). Sub-bass layer + mid punch. */\n  playHit(intensity: number): void {\n    this._play((t, ctx) => {\n      const intens = Math.max(0.1, intensity);\n\n      // Main impact: 180-280 Hz \u2192 90 Hz\n      const freq = 180 + 100 * intens;\n      const osc = ctx.createOscillator();\n      const gain = ctx.createGain();\n      osc.type = \"triangle\";\n      osc.frequency.setValueAtTime(freq, t);\n      osc.frequency.exponentialRampToValueAtTime(90, t + 0.15);\n      gain.gain.setValueAtTime(0.22, t);\n      gain.gain.exponentialRampToValueAtTime(0.001, t + 0.15);\n      osc.connect(gain).connect(ctx.destination);\n      osc.start(t);\n      osc.stop(t + 0.16);\n\n      // Sub-bass layer: 55 Hz constant\n      const sub = ctx.createOscillator();\n      const subGain = ctx.createGain();\n      sub.type = \"sine\";\n      sub.frequency.setValueAtTime(55, t);\n      subGain.gain.setValueAtTime(0.18 * intens, t);\n      subGain.gain.exponentialRampToValueAtTime(0.001, t + 0.12);\n      sub.connect(subGain).connect(ctx.destination);\n      sub.start(t);\n      sub.stop(t + 0.13);\n\n      // Click transient (very short noise burst for punch)\n      const clickOsc = ctx.createOscillator();\n      const clickGain = ctx.createGain();\n      clickOsc.type = \"square\";\n      clickOsc.frequency.setValueAtTime(freq * 1.5, t);\n      clickOsc.frequency.exponentialRampToValueAtTime(80, t + 0.03);\n      clickGain.gain.setValueAtTime(0.06, t);\n      clickGain.gain.exponentialRampToValueAtTime(0.001, t + 0.03);\n      clickOsc.connect(clickGain).connect(ctx.destination);\n      clickOsc.start(t);\n      clickOsc.stop(t + 0.04);\n    });\n  }\n\n  /** Extended low buzz with distortion layer (replaces short 120\u219240Hz square). */\n  playMiss(): void {\n    this._play((t, ctx) => {\n      // Main descending buzz: 100 \u2192 30 Hz\n      const osc = ctx.createOscillator();\n      const gain = ctx.createGain();\n      osc.type = \"square\";\n      osc.frequency.setValueAtTime(100, t);\n      osc.frequency.exponentialRampToValueAtTime(30, t + 0.3);\n      gain.gain.setValueAtTime(0.1, t);\n      gain.gain.exponentialRampToValueAtTime(0.001, t + 0.3);\n      osc.connect(gain).connect(ctx.destination);\n      osc.start(t);\n      osc.stop(t + 0.31);\n\n      // Distortion layer: detuned sawtooth\n      const dist = ctx.createOscillator();\n      const distGain = ctx.createGain();\n      dist.type = \"sawtooth\";\n      dist.frequency.setValueAtTime(67, t);\n      dist.frequency.exponentialRampToValueAtTime(22, t + 0.25);\n      distGain.gain.setValueAtTime(0.05, t);\n      distGain.gain.exponentialRampToValueAtTime(0.001, t + 0.25);\n      dist.connect(distGain).connect(ctx.destination);\n      dist.start(t);\n      dist.stop(t + 0.26);\n    });\n  }\n\n  /** Metallic crunch + deep rumble (replaces random 80-240Hz sawtooths). */\n  playDamage(): void {\n    this._play((t, ctx) => {\n      // Sub rumble: 40 Hz\n      const sub = ctx.createOscillator();\n      const subGain = ctx.createGain();\n      sub.type = \"sine\";\n      sub.frequency.setValueAtTime(40, t);\n      subGain.gain.setValueAtTime(0.2, t);\n      subGain.gain.exponentialRampToValueAtTime(0.001, t + 0.2);\n      sub.connect(subGain).connect(ctx.destination);\n      sub.start(t);\n      sub.stop(t + 0.21);\n\n      // Metallic crunch: multiple detuned sawtooths 60-120 Hz\n      for (let i = 0; i < 4; i++) {\n        const osc = ctx.createOscillator();\n        const gain = ctx.createGain();\n        osc.type = \"sawtooth\";\n        const baseFreq = 60 + Math.random() * 60;\n        osc.frequency.setValueAtTime(baseFreq, t);\n        osc.frequency.exponentialRampToValueAtTime(baseFreq * 0.4, t + 0.15);\n        gain.gain.setValueAtTime(0.06, t);\n        gain.gain.exponentialRampToValueAtTime(0.001, t + 0.15);\n        osc.connect(gain).connect(ctx.destination);\n        osc.start(t);\n        osc.stop(t + 0.16);\n      }\n\n      // Noise burst for metallic impact texture\n      const bufSize = ctx.sampleRate * 0.05;\n      const noiseBuf = ctx.createBuffer(1, bufSize, ctx.sampleRate);\n      const data = noiseBuf.getChannelData(0);\n      for (let i = 0; i < bufSize; i++) data[i] = (Math.random() * 2 - 1);\n      const noise = ctx.createBufferSource();\n      noise.buffer = noiseBuf;\n      const noiseGain = ctx.createGain();\n      noiseGain.gain.setValueAtTime(0.08, t);\n      noiseGain.gain.exponentialRampToValueAtTime(0.001, t + 0.05);\n      const bp = ctx.createBiquadFilter();\n      bp.type = \"bandpass\";\n      bp.frequency.value = 200;\n      bp.Q.value = 2;\n      noise.connect(bp).connect(noiseGain).connect(ctx.destination);\n      noise.start(t);\n      noise.stop(t + 0.06);\n    });\n  }\n\n  /** Dark power chord C2-G2-C3 with sawtooth (replaces cheerful C5-E5-G5 arpeggio). */\n  playCombo(): void {\n    this._play((t, ctx) => {\n      const notes = [65.4, 98.0, 130.8]; // C2, G2, C3 \u2014 dark power chord\n      notes.forEach((freq, i) => {\n        const osc = ctx.createOscillator();\n        const gain = ctx.createGain();\n        osc.type = \"sawtooth\";\n        osc.frequency.setValueAtTime(freq, t + i * 0.04);\n        gain.gain.setValueAtTime(0.1, t + i * 0.04);\n        gain.gain.exponentialRampToValueAtTime(0.001, t + i * 0.04 + 0.25);\n        // Low-pass to keep it dark and rumbling\n        const lp = ctx.createBiquadFilter();\n        lp.type = \"lowpass\";\n        lp.frequency.value = 500;\n        osc.connect(lp).connect(gain).connect(ctx.destination);\n        osc.start(t + i * 0.04);\n        osc.stop(t + i * 0.04 + 0.26);\n      });\n\n      // Sub reinforcement\n      const sub = ctx.createOscillator();\n      const subGain = ctx.createGain();\n      sub.type = \"sine\";\n      sub.frequency.setValueAtTime(32.7, t); // C1\n      subGain.gain.setValueAtTime(0.12, t);\n      subGain.gain.exponentialRampToValueAtTime(0.001, t + 0.3);\n      sub.connect(subGain).connect(ctx.destination);\n      sub.start(t);\n      sub.stop(t + 0.31);\n    });\n  }\n}\n", "import type { HandDebugInfo, Vec2 } from \"../game/types.ts\";\n\nexport type InputMode = \"gyro\" | \"mouse\" | \"none\";\n\n// Gyro sensitivity: degrees of tilt from reference to reach screen edge\nconst GYRO_RANGE_DEG = 25;\n\n// 3x3 matrix stored as a flat 9-element array (row-major)\ntype Mat3 = [\n  number, number, number,\n  number, number, number,\n  number, number, number,\n];\n\nexport class InputManager {\n  /** Smoothed cursor position in game coordinates [0,1]. */\n  cursor: Vec2 = { x: 0.5, y: 0.5 };\n  mode: InputMode = \"none\";\n  detected = false;\n  /** Debug information for the overlay. */\n  debugInfo: HandDebugInfo = {\n    detected: false,\n    confidence: 0,\n    landmarks: null,\n    cursorRaw: { x: 0.5, y: 0.5 },\n    cursorSmoothed: { x: 0.5, y: 0.5 },\n    inputMode: \"none\",\n  };\n\n  private _rawCursor: Vec2 = { x: 0.5, y: 0.5 };\n  private _smoothingSpeed = 20;\n\n  // Gyro state\n  private _hasGyro = false;\n  private _curAlpha = 0;\n  private _curBeta = 0;\n  private _curGamma = 0;\n  private _refMatrix: Mat3 | null = null;\n\n  constructor(private _canvas: HTMLCanvasElement) {}\n\n  /** Request gyro permission (must be called from a user gesture on iOS). */\n  async requestGyroPermission(): Promise<boolean> {\n    // deno-lint-ignore no-explicit-any\n    const DOE = DeviceOrientationEvent as any;\n    if (typeof DOE.requestPermission === \"function\") {\n      try {\n        const result = await DOE.requestPermission();\n        return result === \"granted\";\n      } catch {\n        return false;\n      }\n    }\n    // Non-iOS \u2014 permission not required\n    return true;\n  }\n\n  async init(): Promise<InputMode> {\n    // Try gyro first (mobile devices)\n    if (window.DeviceOrientationEvent) {\n      const permitted = await this.requestGyroPermission();\n      if (permitted) {\n        this._initGyro();\n        // Wait briefly for first event to confirm sensor exists\n        await new Promise<void>((resolve) => setTimeout(resolve, 200));\n        if (this._hasGyro) {\n          this.mode = \"gyro\";\n          return \"gyro\";\n        }\n      }\n    }\n\n    // Fall back to mouse (desktop)\n    this._initMouse();\n    this.mode = \"mouse\";\n    return \"mouse\";\n  }\n\n  update(dt: number): void {\n    if (this.mode === \"gyro\" && this._hasGyro) {\n      this._updateGyro();\n    }\n\n    // Smooth cursor toward raw target\n    const factor = 1 - Math.exp(-this._smoothingSpeed * dt);\n    this.cursor.x += (this._rawCursor.x - this.cursor.x) * factor;\n    this.cursor.y += (this._rawCursor.y - this.cursor.y) * factor;\n\n    // Update debug info\n    this.debugInfo = {\n      detected: this.mode !== \"none\",\n      confidence: this.mode === \"gyro\" ? 1 : 0,\n      landmarks: null,\n      cursorRaw: { x: this._rawCursor.x, y: this._rawCursor.y },\n      cursorSmoothed: { x: this.cursor.x, y: this.cursor.y },\n      inputMode: this.mode,\n    };\n  }\n\n  /** Reset the gyro reference to the current phone orientation. */\n  recenter(): void {\n    this._refMatrix = orientationMatrix(\n      this._curAlpha,\n      this._curBeta,\n      this._curGamma,\n    );\n  }\n\n  // ---- Gyro input ----\n\n  private _initGyro(): void {\n    window.addEventListener(\"deviceorientation\", (e: DeviceOrientationEvent) => {\n      if (e.alpha === null || e.beta === null || e.gamma === null) return;\n      this._hasGyro = true;\n      this._curAlpha = e.alpha;\n      this._curBeta = e.beta;\n      this._curGamma = e.gamma;\n\n      // Auto-set reference on first reading\n      if (this._refMatrix === null) {\n        this._refMatrix = orientationMatrix(e.alpha, e.beta, e.gamma);\n      }\n    });\n  }\n\n  private _updateGyro(): void {\n    if (this._refMatrix === null) return;\n\n    // Current orientation as rotation matrix\n    const curMatrix = orientationMatrix(\n      this._curAlpha,\n      this._curBeta,\n      this._curGamma,\n    );\n\n    // Relative rotation: Rrel = transpose(Rref) * Rcur\n    const refInv = transpose3x3(this._refMatrix);\n    const rel = mul3x3(refInv, curMatrix);\n\n    // Extract where the device's screen-normal (Z axis) points in reference frame.\n    // Third column of rel = [rel[2], rel[5], rel[8]]\n    const vx = rel[2];\n    const vy = rel[5];\n    const vz = rel[8];\n\n    // Decompose into yaw (left/right) and pitch (up/down) in device space\n    const devYaw = Math.atan2(vx, vz);\n    const devPitch = Math.atan2(-vy, vz);\n\n    // Rotate by screen orientation angle to get screen-space deltas\n    const sa = screenAngle();\n    const cosA = Math.cos(sa);\n    const sinA = Math.sin(sa);\n    const screenX = devYaw * cosA - devPitch * sinA;\n    const screenY = devYaw * sinA + devPitch * cosA;\n\n    // Map angular displacement to [0, 1], centered at 0.5\n    const rangRad = deg2rad(GYRO_RANGE_DEG);\n    this._rawCursor.x = clamp(0.5 + screenX / (2 * rangRad), 0, 1);\n    this._rawCursor.y = clamp(0.5 + screenY / (2 * rangRad), 0, 1);\n  }\n\n  // ---- Mouse input (desktop fallback) ----\n\n  private _initMouse(): void {\n    this._canvas.addEventListener(\"mousemove\", (e: MouseEvent) => {\n      const rect = this._canvas.getBoundingClientRect();\n      this._rawCursor.x = clamp((e.clientX - rect.left) / rect.width, 0, 1);\n      this._rawCursor.y = clamp((e.clientY - rect.top) / rect.height, 0, 1);\n      this.detected = true;\n    });\n  }\n}\n\n// ---- Math helpers ----\n\nfunction deg2rad(d: number): number {\n  return d * Math.PI / 180;\n}\n\n/**\n * Build a rotation matrix from W3C DeviceOrientation Euler angles.\n * Convention: ZXY intrinsic Tait-Bryan (alpha=Z, beta=X, gamma=Y).\n * Returns a row-major 3x3 matrix mapping device coords to world coords.\n */\nfunction orientationMatrix(\n  alphaDeg: number,\n  betaDeg: number,\n  gammaDeg: number,\n): Mat3 {\n  const a = deg2rad(alphaDeg); // Z rotation (compass heading)\n  const b = deg2rad(betaDeg);  // X rotation (front-back tilt)\n  const g = deg2rad(gammaDeg); // Y rotation (left-right tilt)\n\n  const ca = Math.cos(a);\n  const sa = Math.sin(a);\n  const cb = Math.cos(b);\n  const sb = Math.sin(b);\n  const cg = Math.cos(g);\n  const sg = Math.sin(g);\n\n  // R = Rz(alpha) * Rx(beta) * Ry(gamma)\n  // Expanded:\n  return [\n    ca * cg - sa * sb * sg,  -sa * cb,  ca * sg + sa * sb * cg,\n    sa * cg + ca * sb * sg,   ca * cb,  sa * sg - ca * sb * cg,\n    -cb * sg,                  sb,       cb * cg,\n  ];\n}\n\nfunction transpose3x3(m: Mat3): Mat3 {\n  return [\n    m[0], m[3], m[6],\n    m[1], m[4], m[7],\n    m[2], m[5], m[8],\n  ];\n}\n\nfunction mul3x3(a: Mat3, b: Mat3): Mat3 {\n  return [\n    a[0] * b[0] + a[1] * b[3] + a[2] * b[6],\n    a[0] * b[1] + a[1] * b[4] + a[2] * b[7],\n    a[0] * b[2] + a[1] * b[5] + a[2] * b[8],\n\n    a[3] * b[0] + a[4] * b[3] + a[5] * b[6],\n    a[3] * b[1] + a[4] * b[4] + a[5] * b[7],\n    a[3] * b[2] + a[4] * b[5] + a[5] * b[8],\n\n    a[6] * b[0] + a[7] * b[3] + a[8] * b[6],\n    a[6] * b[1] + a[7] * b[4] + a[8] * b[7],\n    a[6] * b[2] + a[7] * b[5] + a[8] * b[8],\n  ];\n}\n\n/** Get screen orientation angle in radians (0 = portrait, pi/2 = landscape-left). */\nfunction screenAngle(): number {\n  // deno-lint-ignore no-explicit-any\n  const orient = (screen as any).orientation;\n  if (orient && typeof orient.angle === \"number\") {\n    return deg2rad(orient.angle);\n  }\n  // Fallback for older browsers\n  return deg2rad(window.orientation as number || 0);\n}\n\nfunction clamp(v: number, min: number, max: number): number {\n  return Math.max(min, Math.min(max, v));\n}\n", "import type { Game } from \"../game/game.ts\";\nimport type { HandDebugInfo, Vec2 } from \"../game/types.ts\";\nimport {\n  APPROACH_TIME,\n  CURSOR_RADIUS,\n  HIT_RADIUS,\n} from \"../game/constants.ts\";\n\n// =========================================================================\n// Constants\n// =========================================================================\n\nconst FAR_Z = 5;\nconst RING_COUNT = 28;       // more rings for a denser tunnel\nconst STREAK_COUNT = 80;     // more speed streaks\nconst TUNNEL_RADIUS = 0.85;  // wider tunnel fills more of the screen\nconst SIDES = 4;             // rectangular cross-section\nconst MAX_LINES = 5000;      // increased for denser mesh\nconst MAX_CIRCLES = 600;     // max circle quads per frame\nconst RING_SEGMENTS = 24;    // polygon approximation for circle outlines\nconst PARALLAX_STRENGTH = 0.25; // how much cursor shifts the vanishing point\n\n/** Landmark indices for palm centroid highlight in debug overlay. */\nconst PALM_INDICES = [0, 5, 9, 13, 17];\n\n/** MediaPipe hand skeleton connections for debug visualization. */\nconst HAND_SKELETON: [number, number][] = [\n  [0, 1], [1, 2], [2, 3], [3, 4],         // thumb\n  [0, 5], [5, 6], [6, 7], [7, 8],         // index\n  [5, 9], [9, 10], [10, 11], [11, 12],    // middle\n  [9, 13], [13, 14], [14, 15], [15, 16],  // ring\n  [13, 17], [17, 18], [18, 19], [19, 20], // pinky\n  [0, 17],                                 // palm edge\n];\n\n// =========================================================================\n// Color helpers\n// =========================================================================\n\nfunction hsl(h: number, s: number, l: number): [number, number, number] {\n  h = ((h % 360) + 360) % 360;\n  const c = (1 - Math.abs(2 * l - 1)) * s;\n  const hp = h / 60;\n  const x = c * (1 - Math.abs(hp % 2 - 1));\n  const m = l - c / 2;\n  let r = 0, g = 0, b = 0;\n  if (hp < 1) { r = c; g = x; }\n  else if (hp < 2) { r = x; g = c; }\n  else if (hp < 3) { g = c; b = x; }\n  else if (hp < 4) { g = x; b = c; }\n  else if (hp < 5) { r = x; b = c; }\n  else { r = c; b = x; }\n  return [r + m, g + m, b + m];\n}\n\n// Pre-computed named colors (RGB 0-1)\nconst COL = {\n  cursor:     [0, 1, 1] as [number, number, number],        // #0ff cyan\n  target:     [1, 0, 1] as [number, number, number],        // #f0f magenta\n  projectile: [1, 0.267, 0.267] as [number, number, number],// #f44\n  perfect:    [1, 1, 0] as [number, number, number],        // #ff0\n  good:       [0, 1, 0] as [number, number, number],        // #0f0\n  miss:       [1, 0.267, 0.267] as [number, number, number],// #f44\n  white:      [1, 1, 1] as [number, number, number],\n};\n\n// =========================================================================\n// Shader sources (GLSL 300 es)\n// =========================================================================\n\n// --- Flat shader: lines and triangles with per-vertex color ---\nconst FLAT_VS = `#version 300 es\nin vec2 a_pos;\nin vec4 a_color;\nuniform vec2 u_res;\nuniform vec2 u_shake;\nout vec4 v_color;\nvoid main() {\n  vec2 p = (a_pos + u_shake) / u_res * 2.0 - 1.0;\n  p.y = -p.y;\n  gl_Position = vec4(p, 0.0, 1.0);\n  v_color = a_color;\n}`;\n\nconst FLAT_FS = `#version 300 es\nprecision mediump float;\nin vec4 v_color;\nout vec4 fragColor;\nvoid main() {\n  fragColor = v_color;\n}`;\n\n// --- Circle shader: quads with SDF circle in fragment ---\nconst CIRCLE_VS = `#version 300 es\nin vec2 a_center;\nin vec2 a_offset;\nin float a_radius;\nin vec4 a_color;\nuniform vec2 u_res;\nuniform vec2 u_shake;\nout vec2 v_uv;\nout vec4 v_color;\nvoid main() {\n  vec2 pos = a_center + a_offset * a_radius + u_shake;\n  vec2 ndc = pos / u_res * 2.0 - 1.0;\n  ndc.y = -ndc.y;\n  gl_Position = vec4(ndc, 0.0, 1.0);\n  v_uv = a_offset;\n  v_color = a_color;\n}`;\n\nconst CIRCLE_FS = `#version 300 es\nprecision mediump float;\nin vec2 v_uv;\nin vec4 v_color;\nout vec4 fragColor;\nvoid main() {\n  float dist = length(v_uv);\n  float alpha = 1.0 - smoothstep(0.85, 1.0, dist);\n  fragColor = vec4(v_color.rgb, v_color.a * alpha);\n}`;\n\n// --- Screen quad vertex shader (shared by all post-processing) ---\nconst SCREEN_VS = `#version 300 es\nin vec2 a_pos;\nout vec2 v_uv;\nvoid main() {\n  gl_Position = vec4(a_pos, 0.0, 1.0);\n  v_uv = a_pos * 0.5 + 0.5;\n}`;\n\n// --- Background gradient ---\nconst BG_FS = `#version 300 es\nprecision mediump float;\nin vec2 v_uv;\nuniform vec3 u_cCenter;\nuniform vec3 u_cEdge;\nuniform float u_aspect;\nout vec4 fragColor;\nvoid main() {\n  vec2 p = (v_uv - 0.5) * vec2(u_aspect, 1.0);\n  float d = length(p) * 1.25;\n  vec3 c = mix(u_cCenter, u_cEdge, clamp(d, 0.0, 1.0));\n  fragColor = vec4(c, 1.0);\n}`;\n\n// --- Vanishing point glow (additive radial) ---\nconst GLOW_FS = `#version 300 es\nprecision mediump float;\nin vec2 v_uv;\nuniform vec3 u_color;\nuniform float u_alpha;\nuniform float u_radius;\nuniform float u_aspect;\nout vec4 fragColor;\nvoid main() {\n  vec2 p = (v_uv - 0.5) * vec2(u_aspect, 1.0);\n  float d = length(p) / u_radius;\n  float a = max(0.0, 1.0 - d) * u_alpha;\n  fragColor = vec4(u_color * a, a);\n}`;\n\n// --- Bloom bright extraction ---\nconst EXTRACT_FS = `#version 300 es\nprecision mediump float;\nin vec2 v_uv;\nuniform sampler2D u_tex;\nuniform float u_threshold;\nout vec4 fragColor;\nvoid main() {\n  vec4 c = texture(u_tex, v_uv);\n  float br = dot(c.rgb, vec3(0.2126, 0.7152, 0.0722));\n  float contrib = max(br - u_threshold, 0.0);\n  fragColor = vec4(c.rgb * (contrib / max(br, 0.001)), 1.0);\n}`;\n\n// --- Gaussian blur (separable, 9-tap) ---\nconst BLUR_FS = `#version 300 es\nprecision mediump float;\nin vec2 v_uv;\nuniform sampler2D u_tex;\nuniform vec2 u_dir;\nout vec4 fragColor;\nvoid main() {\n  float w[5] = float[](0.227027, 0.194596, 0.121621, 0.054054, 0.016216);\n  vec4 sum = texture(u_tex, v_uv) * w[0];\n  for (int i = 1; i < 5; i++) {\n    vec2 off = u_dir * float(i) * 1.5;\n    sum += texture(u_tex, v_uv + off) * w[i];\n    sum += texture(u_tex, v_uv - off) * w[i];\n  }\n  fragColor = sum;\n}`;\n\n// --- Final composite with scanlines + vignette ---\nconst FINAL_FS = `#version 300 es\nprecision highp float;\nin vec2 v_uv;\nuniform sampler2D u_scene;\nuniform sampler2D u_bloom;\nuniform float u_bloomStr;\nuniform float u_scanStr;\nuniform float u_vigStr;\nout vec4 fragColor;\nvoid main() {\n  vec3 scene = texture(u_scene, v_uv).rgb;\n  vec3 bloom = texture(u_bloom, v_uv).rgb;\n  vec3 color = scene + bloom * u_bloomStr;\n  float scan = pow(sin(gl_FragCoord.y * 3.14159265 / 3.0), 2.0);\n  color *= 1.0 - u_scanStr * scan;\n  vec2 q = v_uv * 2.0 - 1.0;\n  float vig = 1.0 - dot(q, q) * u_vigStr;\n  color *= max(vig, 0.0);\n  color *= 1.2;\n  color = pow(clamp(color, 0.0, 1.0), vec3(1.0 / 1.6));\n  fragColor = vec4(color, 1.0);\n}`;\n\n// =========================================================================\n// GL helpers\n// =========================================================================\n\nfunction compileShader(gl: WebGL2RenderingContext, type: number, src: string): WebGLShader {\n  const s = gl.createShader(type)!;\n  gl.shaderSource(s, src);\n  gl.compileShader(s);\n  if (!gl.getShaderParameter(s, gl.COMPILE_STATUS)) {\n    const info = gl.getShaderInfoLog(s);\n    gl.deleteShader(s);\n    throw new Error(\"Shader compile error: \" + info);\n  }\n  return s;\n}\n\nfunction linkProgram(gl: WebGL2RenderingContext, vsSrc: string, fsSrc: string): WebGLProgram {\n  const vs = compileShader(gl, gl.VERTEX_SHADER, vsSrc);\n  const fs = compileShader(gl, gl.FRAGMENT_SHADER, fsSrc);\n  const p = gl.createProgram()!;\n  gl.attachShader(p, vs);\n  gl.attachShader(p, fs);\n  gl.linkProgram(p);\n  if (!gl.getProgramParameter(p, gl.LINK_STATUS)) {\n    const info = gl.getProgramInfoLog(p);\n    gl.deleteProgram(p);\n    throw new Error(\"Program link error: \" + info);\n  }\n  gl.deleteShader(vs);\n  gl.deleteShader(fs);\n  return p;\n}\n\ninterface FBO {\n  fb: WebGLFramebuffer;\n  tex: WebGLTexture;\n  w: number;\n  h: number;\n}\n\nfunction createFBO(gl: WebGL2RenderingContext, w: number, h: number): FBO {\n  const tex = gl.createTexture()!;\n  gl.bindTexture(gl.TEXTURE_2D, tex);\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA16F, w, h, 0, gl.RGBA, gl.HALF_FLOAT, null);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n  const fb = gl.createFramebuffer()!;\n  gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\n  gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, tex, 0);\n  gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n  gl.bindTexture(gl.TEXTURE_2D, null);\n  return { fb, tex, w, h };\n}\n\nfunction resizeFBO(gl: WebGL2RenderingContext, fbo: FBO, w: number, h: number): void {\n  fbo.w = w;\n  fbo.h = h;\n  gl.bindTexture(gl.TEXTURE_2D, fbo.tex);\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA16F, w, h, 0, gl.RGBA, gl.HALF_FLOAT, null);\n  gl.bindTexture(gl.TEXTURE_2D, null);\n}\n\n// =========================================================================\n// Streak interface\n// =========================================================================\n\ninterface Streak {\n  angle: number;\n  radius: number;\n  z: number;\n  speed: number;\n  brightness: number;\n}\n\n// =========================================================================\n// Renderer\n// =========================================================================\n\nexport class Renderer {\n  private gl: WebGL2RenderingContext;\n  private hud: CanvasRenderingContext2D;\n  private w = 0;  // CSS pixels\n  private h = 0;\n  private dpr = 1;\n\n  // --- Shader programs ---\n  private flatProg: WebGLProgram;\n  private flatLocs: { aPos: number; aColor: number; uRes: WebGLUniformLocation; uShake: WebGLUniformLocation };\n\n  private circleProg: WebGLProgram;\n  private circleLocs: { aCenter: number; aOffset: number; aRadius: number; aColor: number; uRes: WebGLUniformLocation; uShake: WebGLUniformLocation };\n\n  private bgProg: WebGLProgram;\n  private glowProg: WebGLProgram;\n  private extractProg: WebGLProgram;\n  private blurProg: WebGLProgram;\n  private finalProg: WebGLProgram;\n\n  // --- Geometry buffers ---\n  private lineVAO: WebGLVertexArrayObject;\n  private lineVBO: WebGLBuffer;\n  private lineData: Float32Array;\n  private lineCount = 0;\n\n  private circleVAO: WebGLVertexArrayObject;\n  private circleVBO: WebGLBuffer;\n  private circleData: Float32Array;\n  private circleCount = 0;\n\n  private quadVAO: WebGLVertexArrayObject;\n\n  // --- Framebuffers ---\n  private sceneFBO: FBO;\n  private bloomFBO: [FBO, FBO];\n\n  // --- Tunnel state ---\n  private rings: number[] = [];\n  private streaks: Streak[] = [];\n  private tunnelSpeed = 0;\n  private lastRenderTime = 0;\n  private shakeX = 0;\n  private shakeY = 0;\n  private shakeDecay = 0;\n  private energyIdx = 0;\n  // Parallax camera offset \u2014 smoothly follows cursor for 3D effect\n  private camOffX = 0;\n  private camOffY = 0;\n\n  // Debug overlay state\n  private _debugVisible = false;\n  private _debugInfo: HandDebugInfo | null = null;\n  private _video: HTMLVideoElement;\n\n  muteButtonRect = { x: 0, y: 0, w: 0, h: 0 };\n  buildTimestamp = \"dev\";\n\n  constructor(private glCanvas: HTMLCanvasElement, private hudCanvas: HTMLCanvasElement, video: HTMLVideoElement) {\n    this._video = video;\n\n    // --- WebGL context ---\n    const gl = glCanvas.getContext(\"webgl2\", { alpha: false, antialias: false, premultipliedAlpha: false });\n    if (!gl) throw new Error(\"WebGL 2 not supported\");\n    this.gl = gl;\n\n    // Check for float texture support (required for HDR bloom)\n    const ext = gl.getExtension(\"EXT_color_buffer_half_float\");\n    if (!ext) {\n      // Fallback: try regular float\n      gl.getExtension(\"EXT_color_buffer_float\");\n    }\n\n    // --- HUD context ---\n    const hud = hudCanvas.getContext(\"2d\");\n    if (!hud) throw new Error(\"Cannot get 2d context for HUD\");\n    this.hud = hud;\n\n    // --- Compile programs ---\n    this.flatProg = linkProgram(gl, FLAT_VS, FLAT_FS);\n    this.flatLocs = {\n      aPos: gl.getAttribLocation(this.flatProg, \"a_pos\"),\n      aColor: gl.getAttribLocation(this.flatProg, \"a_color\"),\n      uRes: gl.getUniformLocation(this.flatProg, \"u_res\")!,\n      uShake: gl.getUniformLocation(this.flatProg, \"u_shake\")!,\n    };\n\n    this.circleProg = linkProgram(gl, CIRCLE_VS, CIRCLE_FS);\n    this.circleLocs = {\n      aCenter: gl.getAttribLocation(this.circleProg, \"a_center\"),\n      aOffset: gl.getAttribLocation(this.circleProg, \"a_offset\"),\n      aRadius: gl.getAttribLocation(this.circleProg, \"a_radius\"),\n      aColor: gl.getAttribLocation(this.circleProg, \"a_color\"),\n      uRes: gl.getUniformLocation(this.circleProg, \"u_res\")!,\n      uShake: gl.getUniformLocation(this.circleProg, \"u_shake\")!,\n    };\n\n    this.bgProg = linkProgram(gl, SCREEN_VS, BG_FS);\n    this.glowProg = linkProgram(gl, SCREEN_VS, GLOW_FS);\n    this.extractProg = linkProgram(gl, SCREEN_VS, EXTRACT_FS);\n    this.blurProg = linkProgram(gl, SCREEN_VS, BLUR_FS);\n    this.finalProg = linkProgram(gl, SCREEN_VS, FINAL_FS);\n\n    // --- Line buffer ---\n    this.lineData = new Float32Array(MAX_LINES * 2 * 6); // 2 verts \u00D7 6 floats\n    this.lineVBO = gl.createBuffer()!;\n    this.lineVAO = gl.createVertexArray()!;\n    gl.bindVertexArray(this.lineVAO);\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.lineVBO);\n    gl.bufferData(gl.ARRAY_BUFFER, this.lineData.byteLength, gl.DYNAMIC_DRAW);\n    const Lstride = 6 * 4;\n    gl.enableVertexAttribArray(this.flatLocs.aPos);\n    gl.vertexAttribPointer(this.flatLocs.aPos, 2, gl.FLOAT, false, Lstride, 0);\n    gl.enableVertexAttribArray(this.flatLocs.aColor);\n    gl.vertexAttribPointer(this.flatLocs.aColor, 4, gl.FLOAT, false, Lstride, 8);\n    gl.bindVertexArray(null);\n\n    // --- Circle buffer ---\n    // Per vertex: center(2) + offset(2) + radius(1) + color(4) = 9 floats\n    this.circleData = new Float32Array(MAX_CIRCLES * 6 * 9);\n    this.circleVBO = gl.createBuffer()!;\n    this.circleVAO = gl.createVertexArray()!;\n    gl.bindVertexArray(this.circleVAO);\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.circleVBO);\n    gl.bufferData(gl.ARRAY_BUFFER, this.circleData.byteLength, gl.DYNAMIC_DRAW);\n    const CSTRIDE = 9 * 4;\n    gl.enableVertexAttribArray(this.circleLocs.aCenter);\n    gl.vertexAttribPointer(this.circleLocs.aCenter, 2, gl.FLOAT, false, CSTRIDE, 0);\n    gl.enableVertexAttribArray(this.circleLocs.aOffset);\n    gl.vertexAttribPointer(this.circleLocs.aOffset, 2, gl.FLOAT, false, CSTRIDE, 8);\n    gl.enableVertexAttribArray(this.circleLocs.aRadius);\n    gl.vertexAttribPointer(this.circleLocs.aRadius, 1, gl.FLOAT, false, CSTRIDE, 16);\n    gl.enableVertexAttribArray(this.circleLocs.aColor);\n    gl.vertexAttribPointer(this.circleLocs.aColor, 4, gl.FLOAT, false, CSTRIDE, 20);\n    gl.bindVertexArray(null);\n\n    // --- Fullscreen quad ---\n    this.quadVAO = gl.createVertexArray()!;\n    const quadVBO = gl.createBuffer()!;\n    gl.bindVertexArray(this.quadVAO);\n    gl.bindBuffer(gl.ARRAY_BUFFER, quadVBO);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1,-1, 1,-1, -1,1, -1,1, 1,-1, 1,1]), gl.STATIC_DRAW);\n    gl.enableVertexAttribArray(0);\n    gl.vertexAttribPointer(0, 2, gl.FLOAT, false, 0, 0);\n    gl.bindVertexArray(null);\n\n    // --- FBOs (will be sized in resize()) ---\n    this.sceneFBO = createFBO(gl, 2, 2);\n    this.bloomFBO = [createFBO(gl, 2, 2), createFBO(gl, 2, 2)];\n\n    // --- Init ---\n    this.resize();\n    window.addEventListener(\"resize\", () => this.resize());\n    this.initTunnel();\n  }\n\n  // =========================================================================\n  // Resize\n  // =========================================================================\n\n  resize(): void {\n    this.dpr = window.devicePixelRatio || 1;\n    this.w = window.innerWidth;\n    this.h = window.innerHeight;\n    const pw = this.w * this.dpr;\n    const ph = this.h * this.dpr;\n\n    // WebGL canvas\n    this.glCanvas.width = pw;\n    this.glCanvas.height = ph;\n    this.gl.viewport(0, 0, pw, ph);\n\n    // HUD canvas\n    this.hudCanvas.width = pw;\n    this.hudCanvas.height = ph;\n    this.hud.setTransform(this.dpr, 0, 0, this.dpr, 0, 0);\n\n    // Resize FBOs\n    resizeFBO(this.gl, this.sceneFBO, pw, ph);\n    const bw = Math.max(1, Math.floor(pw / 2));\n    const bh = Math.max(1, Math.floor(ph / 2));\n    resizeFBO(this.gl, this.bloomFBO[0], bw, bh);\n    resizeFBO(this.gl, this.bloomFBO[1], bw, bh);\n  }\n\n  // =========================================================================\n  // Coordinate helpers\n  // =========================================================================\n\n  private px(nx: number): number { return nx * this.w; }\n  private py(ny: number): number { return ny * this.h; }\n  private ps(ns: number): number { return ns * Math.min(this.w, this.h); }\n  private perspScale(z: number): number { return 1 / (1 + z * FAR_Z); }\n\n  // =========================================================================\n  // Batch: Lines\n  // =========================================================================\n\n  private addLine(x1: number, y1: number, x2: number, y2: number,\n                  r: number, g: number, b: number, a: number): void {\n    if (this.lineCount >= MAX_LINES) return;\n    const i = this.lineCount * 12;\n    this.lineData[i]   = x1; this.lineData[i+1] = y1;\n    this.lineData[i+2] = r;  this.lineData[i+3] = g;\n    this.lineData[i+4] = b;  this.lineData[i+5] = a;\n    this.lineData[i+6] = x2; this.lineData[i+7] = y2;\n    this.lineData[i+8] = r;  this.lineData[i+9] = g;\n    this.lineData[i+10]= b;  this.lineData[i+11]= a;\n    this.lineCount++;\n  }\n\n  /** Add a ring outline (polygon) as line segments. */\n  private addRing(cx: number, cy: number, radius: number,\n                  r: number, g: number, b: number, a: number, sides = RING_SEGMENTS): void {\n    for (let i = 0; i < sides; i++) {\n      const a1 = (i / sides) * Math.PI * 2;\n      const a2 = ((i + 1) / sides) * Math.PI * 2;\n      this.addLine(\n        cx + Math.cos(a1) * radius, cy + Math.sin(a1) * radius,\n        cx + Math.cos(a2) * radius, cy + Math.sin(a2) * radius,\n        r, g, b, a\n      );\n    }\n  }\n\n  private flushLines(): void {\n    if (this.lineCount === 0) return;\n    const gl = this.gl;\n    gl.useProgram(this.flatProg);\n    gl.uniform2f(this.flatLocs.uRes, this.w, this.h);\n    gl.uniform2f(this.flatLocs.uShake, this.shakeX, this.shakeY);\n    gl.bindVertexArray(this.lineVAO);\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.lineVBO);\n    gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.lineData.subarray(0, this.lineCount * 12));\n    gl.drawArrays(gl.LINES, 0, this.lineCount * 2);\n    gl.bindVertexArray(null);\n    this.lineCount = 0;\n  }\n\n  // =========================================================================\n  // Batch: Circles (filled, with SDF antialiased edge)\n  // =========================================================================\n\n  private addCircle(cx: number, cy: number, radius: number,\n                    r: number, g: number, b: number, a: number): void {\n    if (this.circleCount >= MAX_CIRCLES) return;\n    const offsets: [number, number][] = [[-1,-1],[1,-1],[1,1],[-1,-1],[1,1],[-1,1]];\n    const base = this.circleCount * 54; // 6 verts \u00D7 9 floats\n    for (let v = 0; v < 6; v++) {\n      const o = base + v * 9;\n      this.circleData[o]   = cx;\n      this.circleData[o+1] = cy;\n      this.circleData[o+2] = offsets[v][0];\n      this.circleData[o+3] = offsets[v][1];\n      this.circleData[o+4] = radius;\n      this.circleData[o+5] = r;\n      this.circleData[o+6] = g;\n      this.circleData[o+7] = b;\n      this.circleData[o+8] = a;\n    }\n    this.circleCount++;\n  }\n\n  private flushCircles(): void {\n    if (this.circleCount === 0) return;\n    const gl = this.gl;\n    gl.useProgram(this.circleProg);\n    gl.uniform2f(this.circleLocs.uRes, this.w, this.h);\n    gl.uniform2f(this.circleLocs.uShake, this.shakeX, this.shakeY);\n    gl.bindVertexArray(this.circleVAO);\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.circleVBO);\n    gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.circleData.subarray(0, this.circleCount * 54));\n    gl.drawArrays(gl.TRIANGLES, 0, this.circleCount * 6);\n    gl.bindVertexArray(null);\n    this.circleCount = 0;\n  }\n\n  // =========================================================================\n  // Fullscreen quad draw\n  // =========================================================================\n\n  private drawQuad(prog: WebGLProgram): void {\n    const gl = this.gl;\n    gl.useProgram(prog);\n    gl.bindVertexArray(this.quadVAO);\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n    gl.bindVertexArray(null);\n  }\n\n  // =========================================================================\n  // Tunnel init & animation\n  // =========================================================================\n\n  private initTunnel(): void {\n    this.rings = [];\n    for (let i = 0; i < RING_COUNT; i++) {\n      this.rings.push(i / RING_COUNT);\n    }\n    this.streaks = [];\n    for (let i = 0; i < STREAK_COUNT; i++) {\n      this.streaks.push({\n        angle: Math.random() * Math.PI * 2,\n        radius: TUNNEL_RADIUS * (0.5 + Math.random() * 0.5),\n        z: Math.random(),\n        speed: 0.4 + Math.random() * 0.6,\n        brightness: 0.4 + Math.random() * 0.6,\n      });\n    }\n  }\n\n  private updateTunnel(dt: number, energy: number, cursor: Vec2): void {\n    const targetSpeed = 0.2 + energy * 0.8;\n    this.tunnelSpeed += (targetSpeed - this.tunnelSpeed) * Math.min(dt * 3, 1);\n    const spd = this.tunnelSpeed;\n\n    for (let i = 0; i < this.rings.length; i++) {\n      this.rings[i] -= spd * dt;\n      if (this.rings[i] < 0) this.rings[i] += 1;\n    }\n\n    for (const s of this.streaks) {\n      s.z -= s.speed * spd * dt;\n      if (s.z < 0.02) {\n        s.z = 0.8 + Math.random() * 0.2;\n        s.angle = Math.random() * Math.PI * 2;\n        s.brightness = 0.4 + Math.random() * 0.6;\n      }\n    }\n\n    // Smoothly move camera offset toward cursor for parallax\n    const targetCamX = (cursor.x - 0.5) * PARALLAX_STRENGTH;\n    const targetCamY = (cursor.y - 0.5) * PARALLAX_STRENGTH;\n    const camSmooth = 1 - Math.exp(-6 * dt);\n    this.camOffX += (targetCamX - this.camOffX) * camSmooth;\n    this.camOffY += (targetCamY - this.camOffY) * camSmooth;\n  }\n\n  private updateShake(dt: number, game: Game): void {\n    for (const effect of game.effects) {\n      if (effect.type === \"damage\" && effect.life > effect.maxLife - 0.05) {\n        const intensity = this.ps(0.02);\n        this.shakeX = (Math.random() - 0.5) * intensity * 2;\n        this.shakeY = (Math.random() - 0.5) * intensity * 2;\n        this.shakeDecay = 0.3;\n      }\n    }\n    if (this.shakeDecay > 0) {\n      this.shakeDecay -= dt;\n      const decay = Math.max(0, this.shakeDecay / 0.3);\n      this.shakeX *= decay;\n      this.shakeY *= decay;\n      if (this.shakeDecay <= 0) { this.shakeX = 0; this.shakeY = 0; }\n    }\n  }\n\n  // =========================================================================\n  // Energy lookup\n  // =========================================================================\n\n  private getEnergy(game: Game): number {\n    const tl = game.beatmap.energyTimeline;\n    if (!tl || tl.length === 0) {\n      const p = game.time / game.beatmap.duration;\n      return 0.2 + p * 0.6;\n    }\n    const t = game.time;\n    if (t < (tl[this.energyIdx]?.time ?? 0)) this.energyIdx = 0;\n    while (this.energyIdx < tl.length - 1 && tl[this.energyIdx + 1].time <= t) {\n      this.energyIdx++;\n    }\n    if (this.energyIdx >= tl.length - 1) return tl[tl.length - 1].energy;\n    const a = tl[this.energyIdx], b = tl[this.energyIdx + 1];\n    const f = (t - a.time) / (b.time - a.time);\n    return a.energy + (b.energy - a.energy) * f;\n  }\n\n  // =========================================================================\n  // Main render\n  // =========================================================================\n\n  render(game: Game, cursor: Vec2, musicMuted = false, debugInfo: HandDebugInfo | null = null): void {\n    const gl = this.gl;\n    const now = performance.now() / 1000;\n    const dt = this.lastRenderTime\n      ? Math.min(now - this.lastRenderTime, 0.1)\n      : 1 / 60;\n    this.lastRenderTime = now;\n\n    // Store debug info for overlay\n    this._debugInfo = debugInfo;\n\n    // Determine phase-specific parameters\n    let energy = 0.15, hue = 220;\n    let drawTargets = false, drawProjectilesFlag = false, drawCursorFlag = false;\n    let drawEffectsFlag = false, drawHUDFlag = false;\n\n    if (game.phase === \"menu\") {\n      energy = 0.15; hue = 220;\n    } else if (game.phase === \"countdown\") {\n      energy = 0.3; hue = 230;\n      drawCursorFlag = true;\n    } else if (game.phase === \"results\") {\n      energy = 0.1; hue = 260;\n    } else if (game.phase === \"gameover\") {\n      energy = 0.05; hue = 0;\n    } else {\n      // playing\n      energy = this.getEnergy(game);\n      const progress = game.time / game.beatmap.duration;\n      hue = 220 + energy * 40 + progress * 20;\n      drawTargets = true;\n      drawProjectilesFlag = true;\n      drawCursorFlag = true;\n      drawEffectsFlag = true;\n      drawHUDFlag = true;\n    }\n\n    this.updateTunnel(dt, energy, cursor);\n    if (game.phase === \"playing\") this.updateShake(dt, game);\n\n    // ---------------------------------------------------------------\n    // Pass 1: Render scene to FBO\n    // ---------------------------------------------------------------\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.sceneFBO.fb);\n    gl.viewport(0, 0, this.sceneFBO.w, this.sceneFBO.h);\n    gl.clearColor(0.024, 0.024, 0.047, 1.0);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n\n    gl.enable(gl.BLEND);\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n\n    // Background gradient\n    this.drawBackground(energy, hue);\n\n    // Vanishing point glow\n    this.drawVanishingGlow(energy, hue);\n\n    // Tunnel mesh (lines) \u2014 drawn with camera shake\n    this.drawTunnelMesh(energy, hue);\n\n    // Game objects\n    if (drawTargets) this.drawTargetsGL(game);\n    if (drawProjectilesFlag) this.drawProjectilesGL(game);\n    if (drawCursorFlag) this.drawCursorGL(cursor);\n    if (drawEffectsFlag) this.drawEffectsGL(game);\n\n    // Flush remaining batched geometry\n    this.flushLines();\n    this.flushCircles();\n\n    // Energy bloom overlay\n    if (energy > 0.55) {\n      const bloom = (energy - 0.55) * 2.2;\n      const [cr, cg, cb] = hsl(hue, 0.8, 0.4);\n      this.drawOverlayRect(cr, cg, cb, bloom * 0.06);\n    }\n\n    // Phase-specific overlays (dim backgrounds for menu/results/gameover)\n    if (game.phase === \"menu\") {\n      this.drawOverlayRect(0.024, 0.024, 0.047, 0.5);\n    } else if (game.phase === \"results\") {\n      this.drawOverlayRect(0.024, 0.024, 0.047, 0.7);\n    } else if (game.phase === \"gameover\") {\n      this.drawGameOverVignette();\n    }\n\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\n    // ---------------------------------------------------------------\n    // Pass 2: Bloom\n    // ---------------------------------------------------------------\n    this.applyBloom();\n\n    // ---------------------------------------------------------------\n    // Pass 3: Final composite to screen\n    // ---------------------------------------------------------------\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n    gl.viewport(0, 0, this.glCanvas.width, this.glCanvas.height);\n\n    gl.useProgram(this.finalProg);\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, this.sceneFBO.tex);\n    gl.uniform1i(gl.getUniformLocation(this.finalProg, \"u_scene\"), 0);\n    gl.activeTexture(gl.TEXTURE1);\n    gl.bindTexture(gl.TEXTURE_2D, this.bloomFBO[0].tex);\n    gl.uniform1i(gl.getUniformLocation(this.finalProg, \"u_bloom\"), 1);\n    gl.uniform1f(gl.getUniformLocation(this.finalProg, \"u_bloomStr\"), 0.6 + energy * 0.8);\n    gl.uniform1f(gl.getUniformLocation(this.finalProg, \"u_scanStr\"), 0.07);\n    gl.uniform1f(gl.getUniformLocation(this.finalProg, \"u_vigStr\"), 0.25);\n    this.drawQuad(this.finalProg);\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n    gl.activeTexture(gl.TEXTURE1);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n\n    // ---------------------------------------------------------------\n    // Pass 4: HUD overlay (Canvas 2D)\n    // ---------------------------------------------------------------\n    this.hud.clearRect(0, 0, this.w, this.h);\n\n    if (game.phase === \"menu\") {\n      this.drawMenuHUD();\n    } else if (game.phase === \"countdown\") {\n      this.drawCountdownHUD(game);\n    } else if (game.phase === \"results\") {\n      this.drawResultsHUD(game);\n    } else if (game.phase === \"gameover\") {\n      this.drawGameOverHUD(game);\n    }\n\n    if (drawHUDFlag) {\n      this.drawPlayingHUD(game, musicMuted, energy);\n    }\n\n    // Debug overlay (toggled with D key)\n    if (this._debugVisible) {\n      this.drawDebugOverlay();\n    }\n  }\n\n  // =========================================================================\n  // Scene: Background\n  // =========================================================================\n\n  private drawBackground(energy: number, hue: number): void {\n    const gl = this.gl;\n    const [cr, cg, cb] = hsl(hue, 0.4, 0.09 + energy * 0.06);\n    const [er, eg, eb] = hsl(hue + 30, 0.25, 0.03 + energy * 0.03);\n\n    gl.useProgram(this.bgProg);\n    gl.uniform3f(gl.getUniformLocation(this.bgProg, \"u_cCenter\"), cr, cg, cb);\n    gl.uniform3f(gl.getUniformLocation(this.bgProg, \"u_cEdge\"), er, eg, eb);\n    gl.uniform1f(gl.getUniformLocation(this.bgProg, \"u_aspect\"), this.w / this.h);\n    this.drawQuad(this.bgProg);\n  }\n\n  private drawVanishingGlow(energy: number, hue: number): void {\n    const gl = this.gl;\n    const [r, g, b] = hsl(hue, 0.6, 0.4 + energy * 0.3);\n    const minDim = Math.min(this.w, this.h);\n    const vpR = minDim * (0.08 + energy * 0.12);\n    const normRadius = vpR / minDim;\n\n    gl.useProgram(this.glowProg);\n    gl.uniform3f(gl.getUniformLocation(this.glowProg, \"u_color\"), r, g, b);\n    gl.uniform1f(gl.getUniformLocation(this.glowProg, \"u_alpha\"), 0.3 + energy * 0.4);\n    gl.uniform1f(gl.getUniformLocation(this.glowProg, \"u_radius\"), normRadius);\n    gl.uniform1f(gl.getUniformLocation(this.glowProg, \"u_aspect\"), this.w / this.h);\n    this.drawQuad(this.glowProg);\n  }\n\n  // =========================================================================\n  // Scene: Overlay rectangles\n  // =========================================================================\n\n  private drawOverlayRect(r: number, g: number, b: number, a: number): void {\n    // Use flat shader with a fullscreen quad\n    // We need to flush any pending lines/circles first, then draw the overlay\n    this.flushLines();\n    this.flushCircles();\n\n    const gl = this.gl;\n    // Draw using the flat shader with 2 triangles covering the screen\n    gl.useProgram(this.flatProg);\n    gl.uniform2f(this.flatLocs.uRes, this.w, this.h);\n    gl.uniform2f(this.flatLocs.uShake, 0, 0); // no shake for overlays\n\n    // Build a temporary quad in the line buffer (reuse line data)\n    const w = this.w, h = this.h;\n    // 2 triangles = 6 vertices \u00D7 6 floats\n    const d = this.lineData;\n    // Triangle 1: (0,0), (w,0), (0,h)\n    let o = 0;\n    d[o++]=0; d[o++]=0; d[o++]=r; d[o++]=g; d[o++]=b; d[o++]=a;\n    d[o++]=w; d[o++]=0; d[o++]=r; d[o++]=g; d[o++]=b; d[o++]=a;\n    d[o++]=0; d[o++]=h; d[o++]=r; d[o++]=g; d[o++]=b; d[o++]=a;\n    // Triangle 2: (w,0), (w,h), (0,h)\n    d[o++]=w; d[o++]=0; d[o++]=r; d[o++]=g; d[o++]=b; d[o++]=a;\n    d[o++]=w; d[o++]=h; d[o++]=r; d[o++]=g; d[o++]=b; d[o++]=a;\n    d[o++]=0; d[o++]=h; d[o++]=r; d[o++]=g; d[o++]=b; d[o++]=a;\n\n    gl.bindVertexArray(this.lineVAO);\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.lineVBO);\n    gl.bufferSubData(gl.ARRAY_BUFFER, 0, d.subarray(0, 36));\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n    gl.bindVertexArray(null);\n  }\n\n  private drawGameOverVignette(): void {\n    // Red vignette gradient using the glow shader (inverted)\n    const gl = this.gl;\n    gl.useProgram(this.glowProg);\n    // Dark red edges, clear center \u2014 we draw a dark overlay first then punch the center\n    // Simpler: just use two overlays\n    // 1. Dark red fill\n    this.drawOverlayRect(0.16, 0, 0, 0.85);\n    // 2. Subtract from center using the glow (we'll draw center as slightly brighter)\n    gl.useProgram(this.glowProg);\n    gl.uniform3f(gl.getUniformLocation(this.glowProg, \"u_color\"), 0.0, 0.0, 0.0);\n    gl.uniform1f(gl.getUniformLocation(this.glowProg, \"u_alpha\"), 0.5);\n    gl.uniform1f(gl.getUniformLocation(this.glowProg, \"u_radius\"), 0.5);\n    gl.uniform1f(gl.getUniformLocation(this.glowProg, \"u_aspect\"), this.w / this.h);\n    // Use subtractive blending to create vignette\n    gl.blendFunc(gl.ONE, gl.ONE);\n    gl.blendEquation(gl.FUNC_REVERSE_SUBTRACT);\n    this.drawQuad(this.glowProg);\n    // Restore normal blend\n    gl.blendEquation(gl.FUNC_ADD);\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n  }\n\n  // =========================================================================\n  // Scene: Tunnel mesh\n  // =========================================================================\n\n  /** Project a 3D tunnel point to 2D screen coords with parallax camera offset. */\n  private tunnelProject(x3d: number, y3d: number, z: number): [number, number] {\n    const scale = this.perspScale(z);\n    // Parallax: offset the vanishing point based on camera, scaled by depth\n    const vpX = this.w / 2 + this.camOffX * this.w * (1 - scale);\n    const vpY = this.h / 2 + this.camOffY * this.h * (1 - scale);\n    return [\n      vpX + x3d * scale * Math.min(this.w, this.h),\n      vpY + y3d * scale * Math.min(this.w, this.h),\n    ];\n  }\n\n  private drawTunnelMesh(energy: number, hue: number): void {\n    const minDim = Math.min(this.w, this.h);\n\n    // --- Sort rings by z for longitudinal connections ---\n    const sortedZ = [...this.rings].sort((a, b) => a - b);\n\n    // Pre-compute rectangular corner offsets (45-degree rotated square)\n    const halfW = TUNNEL_RADIUS * 0.7;\n    const halfH = TUNNEL_RADIUS * 0.5;\n    // Corners: top-left, top-right, bottom-right, bottom-left\n    const corners: [number, number][] = [\n      [-halfW, -halfH], [halfW, -halfH],\n      [halfW, halfH], [-halfW, halfH],\n    ];\n\n    // --- Rectangular rings flying toward the user ---\n    for (const z of this.rings) {\n      const scale = this.perspScale(z);\n      const screenR = minDim * TUNNEL_RADIUS * scale;\n      if (screenR < 2) continue;\n\n      // Closer rings are brighter \u2014 strong proximity falloff\n      const proximity = Math.max(0, 1 - z);\n      const alpha = Math.min(scale * 2, 1) * (0.15 + energy * 0.45) * (0.3 + proximity * 0.7);\n      const lightness = 0.35 + energy * 0.35 + proximity * 0.1;\n      const sat = 0.5 + energy * 0.3;\n      const [rr, rg, rb] = hsl(hue + z * 30, sat, lightness);\n\n      // Subtle rotation based on depth for visual interest\n      const rotOffset = z * Math.PI * 0.08;\n      const cosR = Math.cos(rotOffset);\n      const sinR = Math.sin(rotOffset);\n\n      // Project each corner with parallax\n      const projected: [number, number][] = [];\n      for (const [cx, cy] of corners) {\n        const rx = cx * cosR - cy * sinR;\n        const ry = cx * sinR + cy * cosR;\n        projected.push(this.tunnelProject(rx, ry, z));\n      }\n\n      // Draw the 4 edges of the rectangle\n      for (let i = 0; i < SIDES; i++) {\n        const [x1, y1] = projected[i];\n        const [x2, y2] = projected[(i + 1) % SIDES];\n        this.addLine(x1, y1, x2, y2, rr, rg, rb, alpha);\n      }\n\n      // Draw bright corner dots on close rings for emphasis\n      if (proximity > 0.6) {\n        const dotAlpha = alpha * 1.5 * (proximity - 0.6) / 0.4;\n        for (const [px, py] of projected) {\n          this.addLine(px - 1, py, px + 1, py, 1, 1, 1, dotAlpha);\n        }\n      }\n    }\n\n    // --- Longitudinal mesh lines (connecting adjacent ring corners) ---\n    const [lr, lg, lb] = hsl(hue + 15, 0.4, 0.3 + energy * 0.3);\n    const maxGap = 1.8 / RING_COUNT;\n    for (let j = 0; j < sortedZ.length - 1; j++) {\n      const z1 = sortedZ[j];\n      const z2 = sortedZ[j + 1];\n      if (z2 - z1 > maxGap) continue;\n\n      const s1 = this.perspScale(z1);\n      const s2 = this.perspScale(z2);\n      if (minDim * TUNNEL_RADIUS * s1 < 2 || minDim * TUNNEL_RADIUS * s2 < 2) continue;\n\n      const prox = Math.max(0, 1 - Math.min(z1, z2));\n      const alpha = Math.min(Math.min(s1, s2) * 2, 1) * (0.08 + energy * 0.25) * (0.3 + prox * 0.7);\n\n      const rot1 = z1 * Math.PI * 0.08;\n      const rot2 = z2 * Math.PI * 0.08;\n      const cos1 = Math.cos(rot1), sin1 = Math.sin(rot1);\n      const cos2 = Math.cos(rot2), sin2 = Math.sin(rot2);\n\n      for (let i = 0; i < SIDES; i++) {\n        const [cx1, cy1] = corners[i];\n        const rx1 = cx1 * cos1 - cy1 * sin1;\n        const ry1 = cx1 * sin1 + cy1 * cos1;\n        const [px1, py1] = this.tunnelProject(rx1, ry1, z1);\n\n        const [cx2, cy2] = corners[i];\n        const rx2 = cx2 * cos2 - cy2 * sin2;\n        const ry2 = cx2 * sin2 + cy2 * cos2;\n        const [px2, py2] = this.tunnelProject(rx2, ry2, z2);\n\n        this.addLine(px1, py1, px2, py2, lr, lg, lb, alpha);\n      }\n    }\n\n    // --- Perspective guide lines from vanishing point to screen edges ---\n    const vpX = this.w / 2 + this.camOffX * this.w;\n    const vpY = this.h / 2 + this.camOffY * this.h;\n    const [glR, glG, glB] = hsl(hue, 0.4, 0.25);\n    const glA = 0.05 + energy * 0.08;\n    const edgeTargets: [number, number][] = [\n      [0, 0], [this.w, 0], [this.w, this.h], [0, this.h],\n    ];\n    for (const [ex, ey] of edgeTargets) {\n      this.addLine(vpX, vpY, ex, ey, glR, glG, glB, glA);\n    }\n\n    // --- Speed streaks ---\n    for (const s of this.streaks) {\n      const [sx, sy] = this.tunnelProject(\n        Math.cos(s.angle) * s.radius,\n        Math.sin(s.angle) * s.radius,\n        s.z,\n      );\n\n      const trailZ = s.z + 0.05;\n      const [tx, ty] = this.tunnelProject(\n        Math.cos(s.angle) * s.radius,\n        Math.sin(s.angle) * s.radius,\n        trailZ,\n      );\n\n      const scale = this.perspScale(s.z);\n      const alpha = s.brightness * scale * (0.25 + energy * 0.75);\n      if (alpha < 0.01) continue;\n\n      const [sr, sg, sb] = hsl(hue - 10, 0.5, 0.85);\n      this.addLine(tx, ty, sx, sy, sr, sg, sb, alpha);\n    }\n\n    // Flush all tunnel lines in one draw call\n    this.flushLines();\n  }\n\n  // =========================================================================\n  // Scene: Targets\n  // =========================================================================\n\n  private drawTargetsGL(game: Game): void {\n    const cx = this.w / 2;\n    const cy = this.h / 2;\n\n    for (const target of game.targets) {\n      const timeDiff = game.time - target.time;\n      const approachProgress = 1 - (target.time - game.time) / APPROACH_TIME;\n      if (approachProgress < 0) continue;\n\n      const actualX = this.px(target.x);\n      const actualY = this.py(target.y);\n      const baseR = this.ps(HIT_RADIUS * 0.5);\n\n      // --- Hit: expanding white ring ---\n      if (target.hit) {\n        const hitP = Math.max(0, timeDiff) / 0.3;\n        if (hitP > 1) continue;\n        const r = baseR * (1 + hitP * 2);\n        const alpha = 1 - hitP;\n        this.addRing(actualX, actualY, r, 1, 1, 1, alpha, 16);\n        continue;\n      }\n\n      // --- Miss: fading red dot ---\n      if (target.missed) {\n        const missP = Math.max(0, timeDiff - 0.25) / 0.5;\n        if (missP > 1) continue;\n        const alpha = Math.max(0, 1 - missP) * 0.3;\n        this.addCircle(actualX, actualY, baseR, ...COL.miss, alpha);\n        continue;\n      }\n\n      // --- Active: 3D perspective approach ---\n      const clamped = Math.min(approachProgress, 1);\n      const z = 1 - clamped;\n      const scale = this.perspScale(z);\n\n      const displayX = cx + (actualX - cx) * scale;\n      const displayY = cy + (actualY - cy) * scale;\n      const displayR = Math.max(2, baseR * scale);\n\n      // Landing zone ring + crosshair\n      const landingAlpha = clamped * clamped * 0.6;\n      this.addRing(actualX, actualY, baseR * 1.2, ...COL.target, landingAlpha, 16);\n      const crossLen = baseR * 0.5;\n      this.addLine(actualX - crossLen, actualY, actualX + crossLen, actualY, ...COL.target, landingAlpha);\n      this.addLine(actualX, actualY - crossLen, actualX, actualY + crossLen, ...COL.target, landingAlpha);\n\n      // Connection line\n      if (clamped < 0.9) {\n        const connAlpha = (1 - clamped) * 0.12;\n        this.addLine(displayX, displayY, actualX, actualY, ...COL.target, connAlpha);\n      }\n\n      // Approaching orb\n      const pulse = 1 + Math.sin(game.time * 8) * 0.1;\n      const orbAlpha = Math.min(clamped * 1.5, 0.9);\n\n      // Outer glow\n      this.addCircle(displayX, displayY, displayR * 2.5 * pulse, ...COL.target, orbAlpha * 0.2);\n      // Core\n      this.addCircle(displayX, displayY, displayR * pulse, ...COL.target, orbAlpha);\n      // White center\n      this.addCircle(displayX, displayY, displayR * 0.35, 1, 1, 1, Math.min(clamped * 2, 1));\n    }\n  }\n\n  // =========================================================================\n  // Scene: Projectiles\n  // =========================================================================\n\n  private drawProjectilesGL(game: Game): void {\n    for (const p of game.projectiles) {\n      const pcx = this.px(p.x);\n      const pcy = this.py(p.y);\n      const r = this.ps(0.014);\n\n      // Outer warning glow\n      this.addCircle(pcx, pcy, r * 4, ...COL.projectile, 0.12);\n      // Mid glow\n      this.addCircle(pcx, pcy, r * 2.2, ...COL.projectile, 0.3);\n      // Core\n      this.addCircle(pcx, pcy, r, 1, 1, 1, 1);\n\n      // Direction trail\n      this.addLine(pcx, pcy, pcx - p.dx * r * 6, pcy - p.dy * r * 6, ...COL.projectile, 0.6);\n      this.addLine(pcx - p.dx * r * 6, pcy - p.dy * r * 6,\n                   pcx - p.dx * r * 10, pcy - p.dy * r * 10, ...COL.projectile, 0.25);\n    }\n  }\n\n  // =========================================================================\n  // Scene: Cursor\n  // =========================================================================\n\n  /** Draw cursor with layered glow. */\n  private drawCursorGL(cursor: Vec2): void {\n    const cursorX = this.px(cursor.x);\n    const cursorY = this.py(cursor.y);\n    const r = this.ps(CURSOR_RADIUS);\n\n    // Layered glow\n    this.addCircle(cursorX, cursorY, r * 4, ...COL.cursor, 0.08);\n    this.addCircle(cursorX, cursorY, r * 2.2, ...COL.cursor, 0.2);\n    this.addCircle(cursorX, cursorY, r * 1.4, ...COL.cursor, 0.45);\n    // Core\n    this.addCircle(cursorX, cursorY, r, 1, 1, 1, 1);\n    // Center dot\n    this.addCircle(cursorX, cursorY, r * 0.3, ...COL.cursor, 1);\n  }\n\n  // =========================================================================\n  // Scene: Effects\n  // =========================================================================\n\n  private drawEffectsGL(game: Game): void {\n    for (const effect of game.effects) {\n      const progress = 1 - effect.life / effect.maxLife;\n      const alpha = 1 - progress;\n      const ex = this.px(effect.x);\n      const ey = this.py(effect.y);\n\n      if (effect.type === \"perfect\" || effect.type === \"good\") {\n        const col = effect.type === \"perfect\" ? COL.perfect : COL.good;\n        const r = this.ps(0.04 + progress * 0.1);\n        this.addRing(ex, ey, r, ...col, alpha * 0.6, 16);\n        // Text is drawn on HUD canvas\n      }\n\n      if (effect.type === \"damage\") {\n        const r = this.ps(progress * 0.12);\n        this.addCircle(ex, ey, r, ...COL.projectile, alpha * 0.4);\n        // Full-screen red flash\n        this.flushLines();\n        this.flushCircles();\n        this.drawOverlayRect(1, 0, 0, alpha * 0.18);\n      }\n\n      if (effect.type === \"combo_milestone\") {\n        // Faint fullscreen flash\n        this.flushLines();\n        this.flushCircles();\n        this.drawOverlayRect(...COL.cursor, alpha * 0.08);\n      }\n    }\n  }\n\n  // =========================================================================\n  // Bloom pipeline\n  // =========================================================================\n\n  private applyBloom(): void {\n    const gl = this.gl;\n    gl.disable(gl.BLEND);\n\n    // Step 1: Extract bright pixels\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.bloomFBO[0].fb);\n    gl.viewport(0, 0, this.bloomFBO[0].w, this.bloomFBO[0].h);\n    gl.useProgram(this.extractProg);\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, this.sceneFBO.tex);\n    gl.uniform1i(gl.getUniformLocation(this.extractProg, \"u_tex\"), 0);\n    gl.uniform1f(gl.getUniformLocation(this.extractProg, \"u_threshold\"), 0.3);\n    this.drawQuad(this.extractProg);\n\n    // Step 2: Gaussian blur (2 passes for wider bloom)\n    for (let pass = 0; pass < 2; pass++) {\n      // Horizontal\n      gl.bindFramebuffer(gl.FRAMEBUFFER, this.bloomFBO[1].fb);\n      gl.useProgram(this.blurProg);\n      gl.activeTexture(gl.TEXTURE0);\n      gl.bindTexture(gl.TEXTURE_2D, this.bloomFBO[0].tex);\n      gl.uniform1i(gl.getUniformLocation(this.blurProg, \"u_tex\"), 0);\n      gl.uniform2f(gl.getUniformLocation(this.blurProg, \"u_dir\"), 1.0 / this.bloomFBO[0].w, 0);\n      this.drawQuad(this.blurProg);\n\n      // Vertical\n      gl.bindFramebuffer(gl.FRAMEBUFFER, this.bloomFBO[0].fb);\n      gl.bindTexture(gl.TEXTURE_2D, this.bloomFBO[1].tex);\n      gl.uniform2f(gl.getUniformLocation(this.blurProg, \"u_dir\"), 0, 1.0 / this.bloomFBO[0].h);\n      this.drawQuad(this.blurProg);\n    }\n\n    gl.enable(gl.BLEND);\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n  }\n\n  // =========================================================================\n  // HUD: Neon glow text helper\n  // =========================================================================\n\n  private glowText(text: string, x: number, y: number, color: string, fontSize: number,\n                   bold = false, glowSize = 0): void {\n    const ctx = this.hud;\n    const weight = bold ? \"bold \" : \"\";\n    ctx.font = `${weight}${fontSize}px 'Orbitron', sans-serif`;\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"middle\";\n\n    if (glowSize > 0) {\n      ctx.save();\n      ctx.shadowColor = color;\n      ctx.shadowBlur = glowSize;\n      ctx.fillStyle = color;\n      ctx.fillText(text, x, y);\n      ctx.fillText(text, x, y); // double-draw for stronger glow\n      ctx.restore();\n    }\n\n    ctx.fillStyle = color;\n    ctx.fillText(text, x, y);\n  }\n\n  // =========================================================================\n  // HUD: Playing phase\n  // =========================================================================\n\n  private drawPlayingHUD(game: Game, musicMuted: boolean, energy: number): void {\n    const ctx = this.hud;\n    const pad = this.ps(0.02);\n    const fontSize = this.ps(0.025);\n\n    // --- Score ---\n    ctx.font = `bold ${fontSize}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#fff\";\n    ctx.textAlign = \"left\";\n    ctx.textBaseline = \"top\";\n    ctx.fillText(`${game.score}`, pad, pad);\n\n    // --- Combo ---\n    if (game.combo > 1) {\n      const comboSize = Math.min(fontSize * (1 + game.combo * 0.01), fontSize * 1.5);\n      ctx.font = `bold ${comboSize}px 'Orbitron', sans-serif`;\n      ctx.fillStyle = \"#0ff\";\n      ctx.fillText(`${game.combo}x`, pad, pad + fontSize + 4);\n    }\n\n    // --- Health bar ---\n    const barW = this.ps(0.12);\n    const barH = this.ps(0.01);\n    const barX = this.w - pad - barW;\n    const barY = pad;\n\n    ctx.fillStyle = \"#222\";\n    ctx.fillRect(barX, barY, barW, barH);\n    ctx.fillStyle = game.health > 30 ? \"#0f0\" : \"#f00\";\n    ctx.fillRect(barX, barY, barW * (game.health / 100), barH);\n    ctx.strokeStyle = \"#444\";\n    ctx.lineWidth = 1;\n    ctx.strokeRect(barX, barY, barW, barH);\n\n    ctx.font = `${this.ps(0.012)}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#888\";\n    ctx.textAlign = \"right\";\n    ctx.textBaseline = \"top\";\n    ctx.fillText(\"HP\", barX - 6, barY);\n\n    // --- Energy indicator ---\n    const eBarY = barY + barH + 3;\n    ctx.fillStyle = \"#111\";\n    ctx.fillRect(barX, eBarY, barW, 3);\n    const eHue = 220 + energy * 60;\n    ctx.fillStyle = `hsla(${eHue}, 70%, 50%, 0.8)`;\n    ctx.fillRect(barX, eBarY, barW * energy, 3);\n\n    // --- Progress bar ---\n    const progress = game.time / game.beatmap.duration;\n    const pBarH = 3;\n    const pBarY = this.h - pBarH;\n    ctx.fillStyle = \"#1a1a2a\";\n    ctx.fillRect(0, pBarY, this.w, pBarH);\n    ctx.fillStyle = \"#336\";\n    ctx.fillRect(0, pBarY, this.w * progress, pBarH);\n\n    // --- Time remaining ---\n    const remaining = Math.max(0, game.beatmap.duration - game.time);\n    const mins = Math.floor(remaining / 60);\n    const secs = Math.floor(remaining % 60);\n    ctx.font = `${this.ps(0.014)}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#555\";\n    ctx.textAlign = \"right\";\n    ctx.textBaseline = \"bottom\";\n    ctx.fillText(`${mins}:${secs.toString().padStart(2, \"0\")}`, this.w - pad, pBarY - 4);\n\n    // --- Mute button ---\n    const btnSize = this.ps(0.03);\n    const btnX = this.w - pad - btnSize;\n    const btnY = eBarY + 6 + pad;\n    this.muteButtonRect = { x: btnX, y: btnY, w: btnSize, h: btnSize };\n\n    ctx.fillStyle = musicMuted ? \"#555\" : \"#888\";\n    ctx.font = `${btnSize * 0.8}px 'Orbitron', sans-serif`;\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"middle\";\n    ctx.fillText(\"M\", btnX + btnSize / 2, btnY + btnSize / 2);\n\n    if (musicMuted) {\n      ctx.strokeStyle = \"#f44\";\n      ctx.lineWidth = 2;\n      ctx.beginPath();\n      ctx.moveTo(btnX + 2, btnY + btnSize - 2);\n      ctx.lineTo(btnX + btnSize - 2, btnY + 2);\n      ctx.stroke();\n    }\n\n    // --- Effect text (floaters drawn on HUD) ---\n    for (const effect of game.effects) {\n      const prog = 1 - effect.life / effect.maxLife;\n      const alpha = 1 - prog;\n      const ex = this.px(effect.x);\n      const ey = this.py(effect.y);\n\n      if (effect.type === \"perfect\") {\n        ctx.globalAlpha = alpha;\n        ctx.font = `bold ${this.ps(0.022)}px 'Orbitron', sans-serif`;\n        ctx.fillStyle = \"#ff0\";\n        ctx.textAlign = \"center\";\n        ctx.textBaseline = \"middle\";\n        ctx.fillText(\"PERFECT\", ex, ey - this.ps(0.05 + prog * 0.04));\n        ctx.globalAlpha = 1;\n      }\n\n      if (effect.type === \"good\") {\n        ctx.globalAlpha = alpha;\n        ctx.font = `bold ${this.ps(0.022)}px 'Orbitron', sans-serif`;\n        ctx.fillStyle = \"#0f0\";\n        ctx.textAlign = \"center\";\n        ctx.textBaseline = \"middle\";\n        ctx.fillText(\"GOOD\", ex, ey - this.ps(0.05 + prog * 0.04));\n        ctx.globalAlpha = 1;\n      }\n\n      if (effect.type === \"miss\") {\n        ctx.globalAlpha = alpha;\n        ctx.font = `${this.ps(0.018)}px 'Orbitron', sans-serif`;\n        ctx.fillStyle = \"#f44\";\n        ctx.textAlign = \"center\";\n        ctx.textBaseline = \"middle\";\n        ctx.fillText(\"MISS\", ex, ey - this.ps(0.04 + prog * 0.02));\n        ctx.globalAlpha = 1;\n      }\n\n      if (effect.type === \"combo_milestone\") {\n        ctx.globalAlpha = alpha;\n        const comboFontSize = this.ps(0.06 + prog * 0.02);\n        this.glowText(`${effect.value} COMBO!`, this.w / 2, this.h / 2, \"#0ff\", comboFontSize, true, 20);\n        ctx.globalAlpha = 1;\n      }\n    }\n  }\n\n  // =========================================================================\n  // HUD: Phase overlays\n  // =========================================================================\n\n  private drawMenuHUD(): void {\n    const ctx = this.hud;\n    const cx = this.w / 2;\n    const cy = this.h / 2;\n    const s = (n: number): number => this.ps(n);\n\n    // --- Title ---\n    this.glowText(\"OPAD\", cx, cy - s(0.20), \"#0ff\", s(0.09), true, 30);\n\n    ctx.font = `${s(0.02)}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#888\";\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"middle\";\n    ctx.fillText(\"TUNNEL FLIGHT\", cx, cy - s(0.12));\n\n    // --- Phone + hand illustration ---\n    this.drawPhoneIllustration(cx, cy + s(0.02), s);\n\n    // --- Instructions ---\n    const instY = cy + s(0.21);\n    const lineH = s(0.026);\n\n    ctx.font = `${s(0.016)}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#0ff\";\n    ctx.textAlign = \"center\";\n    ctx.fillText(\"BEST ON MOBILE\", cx, instY);\n\n    ctx.font = `${s(0.013)}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#667\";\n    ctx.fillText(\"Hold phone in LEFT hand  \\u2022  Camera on the RIGHT\", cx, instY + lineH);\n    ctx.fillText(\"Control with your RIGHT hand in front of camera\", cx, instY + lineH * 2);\n\n    // --- Start prompt ---\n    const pulse = 0.4 + 0.6 * Math.abs(Math.sin(Date.now() / 600));\n    ctx.globalAlpha = pulse;\n    ctx.font = `${s(0.018)}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#0ff\";\n    ctx.fillText(\"TAP TO START\", cx, this.h - s(0.10));\n    ctx.globalAlpha = 1;\n\n    // --- Build info + creator ---\n    ctx.font = `${s(0.01)}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#445\";\n    ctx.textAlign = \"center\";\n    ctx.fillText(`Grzegorz Gajos  \\u2022  ggajos.com  \\u2022  build ${this.buildTimestamp}`, cx, this.h - s(0.03));\n  }\n\n  /** Draw a simple schematic: phone held in left hand, right hand waving at camera. */\n  private drawPhoneIllustration(cx: number, cy: number, s: (n: number) => number): void {\n    const ctx = this.hud;\n\n    // --- Left hand (simplified fist holding the phone) ---\n    const handX = cx - s(0.13);\n    const handY = cy;\n    const fR = s(0.012); // finger radius\n\n    ctx.save();\n    ctx.strokeStyle = \"#446\";\n    ctx.lineWidth = 2;\n    ctx.lineJoin = \"round\";\n\n    // Thumb\n    ctx.beginPath();\n    ctx.ellipse(handX - s(0.005), handY - s(0.05), fR * 0.8, fR * 1.6, -0.3, 0, Math.PI * 2);\n    ctx.stroke();\n\n    // Four fingers curled around phone bottom\n    for (let i = 0; i < 4; i++) {\n      const fy = handY + s(0.04) + i * fR * 1.6;\n      ctx.beginPath();\n      ctx.ellipse(handX + s(0.01), fy, fR * 1.8, fR * 0.7, 0, 0, Math.PI * 2);\n      ctx.stroke();\n    }\n    ctx.restore();\n\n    // --- Phone body (landscape, held in left hand) ---\n    const pw = s(0.22);\n    const ph = s(0.13);\n    const px = cx - pw / 2;\n    const py = cy - ph / 2;\n    const cornerR = s(0.012);\n\n    ctx.save();\n    ctx.strokeStyle = \"#556\";\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.roundRect(px, py, pw, ph, cornerR);\n    ctx.stroke();\n\n    // Screen area (inner rect)\n    const inset = s(0.006);\n    ctx.strokeStyle = \"#334\";\n    ctx.lineWidth = 1;\n    ctx.beginPath();\n    ctx.roundRect(px + inset, py + inset, pw - inset * 2, ph - inset * 2, cornerR * 0.5);\n    ctx.stroke();\n\n    // Camera lens (right side of phone in landscape)\n    const camR = s(0.007);\n    const camX = px + pw - s(0.018);\n    const camY = py + s(0.02);\n    ctx.beginPath();\n    ctx.arc(camX, camY, camR, 0, Math.PI * 2);\n    ctx.strokeStyle = \"#0ff\";\n    ctx.lineWidth = 1.5;\n    ctx.stroke();\n\n    // Camera label\n    ctx.font = `${s(0.008)}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#0aa\";\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"top\";\n    ctx.fillText(\"CAM\", camX, camY + camR + 2);\n\n    // Small game scene inside the screen\n    ctx.fillStyle = \"rgba(0, 255, 255, 0.06)\";\n    ctx.fillRect(px + inset, py + inset, pw - inset * 2, ph - inset * 2);\n\n    // Tiny tunnel lines in screen\n    const scrCx = px + pw / 2 - s(0.01);\n    const scrCy = py + ph / 2;\n    ctx.strokeStyle = \"rgba(0, 255, 255, 0.2)\";\n    ctx.lineWidth = 1;\n    for (let a = 0; a < Math.PI * 2; a += Math.PI / 4) {\n      ctx.beginPath();\n      ctx.moveTo(scrCx + Math.cos(a) * s(0.01), scrCy + Math.sin(a) * s(0.008));\n      ctx.lineTo(scrCx + Math.cos(a) * s(0.06), scrCy + Math.sin(a) * s(0.05));\n      ctx.stroke();\n    }\n    ctx.restore();\n\n    // --- Right hand (open, waving in front of camera) ---\n    const rhX = cx + s(0.18);\n    const rhY = cy - s(0.01);\n    this.drawOpenHand(rhX, rhY, s);\n\n    // --- Motion arc (showing hand waving) ---\n    ctx.save();\n    ctx.strokeStyle = \"rgba(0, 255, 255, 0.3)\";\n    ctx.lineWidth = 1.5;\n    ctx.setLineDash([4, 4]);\n\n    // Arrow from hand toward camera\n    const arrowStartX = rhX - s(0.04);\n    const arrowEndX = camX + s(0.025);\n    ctx.beginPath();\n    ctx.moveTo(arrowStartX, rhY);\n    ctx.quadraticCurveTo((arrowStartX + arrowEndX) / 2, rhY - s(0.04), arrowEndX, camY);\n    ctx.stroke();\n    ctx.setLineDash([]);\n    ctx.restore();\n  }\n\n  /** Draw a simple open right hand silhouette. */\n  private drawOpenHand(cx: number, cy: number, s: (n: number) => number): void {\n    const ctx = this.hud;\n    ctx.save();\n    ctx.strokeStyle = \"#0cc\";\n    ctx.fillStyle = \"rgba(0, 204, 204, 0.08)\";\n    ctx.lineWidth = 1.5;\n    ctx.lineJoin = \"round\";\n    ctx.lineCap = \"round\";\n\n    // Palm\n    const palmW = s(0.022);\n    const palmH = s(0.028);\n    ctx.beginPath();\n    ctx.ellipse(cx, cy + s(0.01), palmW, palmH, 0, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.stroke();\n\n    // Five fingers (simplified as lines with round caps)\n    const fingers = [\n      { angle: -1.4, len: s(0.032) },  // thumb (angled out)\n      { angle: -0.5, len: s(0.038) },  // index\n      { angle: -0.2, len: s(0.04) },   // middle\n      { angle: 0.1, len: s(0.037) },   // ring\n      { angle: 0.4, len: s(0.03) },    // pinky\n    ];\n\n    for (const f of fingers) {\n      const baseX = cx + Math.sin(f.angle) * palmW * 0.7;\n      const baseY = cy + s(0.01) - palmH * 0.6;\n      ctx.beginPath();\n      ctx.moveTo(baseX, baseY);\n      ctx.lineTo(\n        baseX + Math.sin(f.angle) * f.len * 0.3,\n        baseY - f.len,\n      );\n      ctx.stroke();\n    }\n\n    // Wrist line\n    ctx.beginPath();\n    ctx.moveTo(cx - palmW * 0.5, cy + palmH + s(0.005));\n    ctx.lineTo(cx - palmW * 0.3, cy + palmH + s(0.025));\n    ctx.moveTo(cx + palmW * 0.5, cy + palmH + s(0.005));\n    ctx.lineTo(cx + palmW * 0.3, cy + palmH + s(0.025));\n    ctx.stroke();\n\n    ctx.restore();\n  }\n\n  private drawCountdownHUD(game: Game): void {\n    const count = Math.max(1, Math.ceil(game.countdownValue));\n    const frac = game.countdownValue % 1;\n    const scale = 1 + frac * 0.3;\n    const size = this.ps(0.12) * scale;\n\n    this.hud.globalAlpha = 0.5 + frac * 0.5;\n    this.glowText(count.toString(), this.w / 2, this.h / 2, \"#0ff\", size, true, 25);\n    this.hud.globalAlpha = 1;\n\n    this.hud.font = `${this.ps(0.02)}px 'Orbitron', sans-serif`;\n    this.hud.fillStyle = \"#666\";\n    this.hud.textAlign = \"center\";\n    this.hud.textBaseline = \"middle\";\n    this.hud.fillText(\"ENTERING TUNNEL\", this.w / 2, this.h / 2 + this.ps(0.1));\n  }\n\n  private drawResultsHUD(game: Game): void {\n    const cx = this.w / 2;\n    const cy = this.h / 2;\n    const lineH = this.ps(0.05);\n    const ctx = this.hud;\n\n    this.glowText(\"MISSION COMPLETE\", cx, cy - lineH * 3, \"#0ff\", this.ps(0.06), true, 25);\n\n    ctx.font = `bold ${this.ps(0.045)}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#fff\";\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"middle\";\n    ctx.fillText(`${game.score}`, cx, cy - lineH * 1.5);\n\n    ctx.font = `${this.ps(0.022)}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#ff0\";\n    ctx.fillText(`PERFECT  ${game.hits.perfect}`, cx, cy);\n    ctx.fillStyle = \"#0f0\";\n    ctx.fillText(`GOOD  ${game.hits.good}`, cx, cy + lineH * 0.8);\n    ctx.fillStyle = \"#f44\";\n    ctx.fillText(`MISS  ${game.hits.miss}`, cx, cy + lineH * 1.6);\n    ctx.fillStyle = \"#0ff\";\n    ctx.fillText(`MAX COMBO  ${game.maxCombo}`, cx, cy + lineH * 2.6);\n\n    const total = game.hits.perfect + game.hits.good + game.hits.miss;\n    const accuracy = total > 0\n      ? Math.round(((game.hits.perfect + game.hits.good * 0.5) / total) * 100)\n      : 0;\n    ctx.fillStyle = \"#fff\";\n    ctx.fillText(`ACCURACY  ${accuracy}%`, cx, cy + lineH * 3.4);\n\n    ctx.font = `${this.ps(0.016)}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#555\";\n    ctx.fillText(\"TAP TO RETRY\", cx, cy + lineH * 4.8);\n  }\n\n  private drawGameOverHUD(game: Game): void {\n    const cx = this.w / 2;\n    const cy = this.h / 2;\n    const lineH = this.ps(0.05);\n    const ctx = this.hud;\n\n    this.glowText(\"SYSTEMS OFFLINE\", cx, cy - lineH * 2.5, \"#f44\", this.ps(0.07), true, 20);\n\n    ctx.font = `bold ${this.ps(0.035)}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#fff\";\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"middle\";\n    ctx.fillText(`SCORE  ${game.score}`, cx, cy - lineH * 0.8);\n\n    ctx.font = `${this.ps(0.022)}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#ff0\";\n    ctx.fillText(`PERFECT  ${game.hits.perfect}`, cx, cy + lineH * 0.2);\n    ctx.fillStyle = \"#0f0\";\n    ctx.fillText(`GOOD  ${game.hits.good}`, cx, cy + lineH * 1.0);\n    ctx.fillStyle = \"#f44\";\n    ctx.fillText(`MISS  ${game.hits.miss}`, cx, cy + lineH * 1.8);\n    ctx.fillStyle = \"#0ff\";\n    ctx.fillText(`MAX COMBO  ${game.maxCombo}`, cx, cy + lineH * 2.8);\n\n    const progress = Math.round((game.time / game.beatmap.duration) * 100);\n    ctx.fillStyle = \"#888\";\n    ctx.fillText(`TUNNEL REACHED  ${progress}%`, cx, cy + lineH * 3.6);\n\n    ctx.font = `${this.ps(0.016)}px 'Orbitron', sans-serif`;\n    ctx.fillStyle = \"#555\";\n    ctx.fillText(\"TAP TO RETRY\", cx, cy + lineH * 5.0);\n  }\n\n  // =========================================================================\n  // Debug overlay (toggled with D key)\n  // =========================================================================\n\n  /** Toggle the debug hand tracking overlay. */\n  toggleDebug(): void {\n    this._debugVisible = !this._debugVisible;\n  }\n\n  /** Draw debug overlay: small camera feed, hand skeleton, and calibration hints. */\n  private drawDebugOverlay(): void {\n    const ctx = this.hud;\n    const info = this._debugInfo;\n\n    const pad = this.ps(0.01);\n    const fontSize = this.ps(0.012);\n    const lineH = fontSize * 1.5;\n\n    // Panel dimensions\n    const panelW = Math.max(this.ps(0.25), 180);\n    const videoH = panelW * (9 / 16); // 16:9 aspect ratio\n    const textAreaH = lineH * 4 + pad * 2;\n    const panelH = videoH + textAreaH;\n    const panelX = pad;\n    const panelY = this.h - pad - panelH;\n\n    ctx.save();\n\n    // Background\n    ctx.globalAlpha = 0.85;\n    ctx.fillStyle = \"#0a0a14\";\n    ctx.fillRect(panelX, panelY, panelW, panelH);\n    ctx.globalAlpha = 1;\n\n    // Border\n    ctx.strokeStyle = \"#334\";\n    ctx.lineWidth = 1;\n    ctx.strokeRect(panelX, panelY, panelW, panelH);\n\n    // --- Draw mirrored camera feed ---\n    const vidX = panelX;\n    const vidY = panelY;\n    try {\n      if (this._video && this._video.readyState >= 2) {\n        ctx.save();\n        ctx.translate(vidX + panelW, vidY);\n        ctx.scale(-1, 1);\n        ctx.drawImage(this._video, 0, 0, panelW, videoH);\n        ctx.restore();\n      } else {\n        ctx.fillStyle = \"#111\";\n        ctx.fillRect(vidX, vidY, panelW, videoH);\n        ctx.fillStyle = \"#444\";\n        ctx.font = `${fontSize}px 'Orbitron', sans-serif`;\n        ctx.textAlign = \"center\";\n        ctx.textBaseline = \"middle\";\n        ctx.fillText(\"NO CAMERA\", vidX + panelW / 2, vidY + videoH / 2);\n      }\n    } catch {\n      // Video not available \u2014 already drew fallback\n    }\n\n    // --- Draw tracking zone rectangle (dashed, shows the 0.15-0.85 mapped region) ---\n    ctx.strokeStyle = \"rgba(0, 255, 0, 0.25)\";\n    ctx.lineWidth = 1;\n    ctx.setLineDash([4, 4]);\n    ctx.strokeRect(\n      vidX + 0.15 * panelW, vidY + 0.15 * videoH,\n      0.7 * panelW, 0.7 * videoH,\n    );\n    ctx.setLineDash([]);\n\n    // --- Draw hand skeleton on camera feed ---\n    if (info && info.landmarks) {\n      const lm = info.landmarks;\n\n      // Draw connections (mirrored X for selfie view)\n      ctx.strokeStyle = \"#0ff\";\n      ctx.lineWidth = 1.5;\n      ctx.globalAlpha = 0.7;\n      for (const [a, b] of HAND_SKELETON) {\n        const ax = vidX + (1 - lm[a].x) * panelW;\n        const ay = vidY + lm[a].y * videoH;\n        const bx = vidX + (1 - lm[b].x) * panelW;\n        const by = vidY + lm[b].y * videoH;\n        ctx.beginPath();\n        ctx.moveTo(ax, ay);\n        ctx.lineTo(bx, by);\n        ctx.stroke();\n      }\n      ctx.globalAlpha = 1;\n\n      // Draw landmark dots\n      const dotR = 2;\n      for (let i = 0; i < lm.length; i++) {\n        const lx = vidX + (1 - lm[i].x) * panelW;\n        const ly = vidY + lm[i].y * videoH;\n        ctx.beginPath();\n        ctx.arc(lx, ly, dotR, 0, Math.PI * 2);\n        ctx.fillStyle = PALM_INDICES.includes(i) ? \"#ff0\" : \"#0ff\";\n        ctx.fill();\n      }\n\n      // Highlight tracking centroid (magenta dot)\n      let sumX = 0, sumY = 0;\n      for (const idx of PALM_INDICES) {\n        sumX += lm[idx].x;\n        sumY += lm[idx].y;\n      }\n      const centX = vidX + (1 - sumX / PALM_INDICES.length) * panelW;\n      const centY = vidY + (sumY / PALM_INDICES.length) * videoH;\n      ctx.beginPath();\n      ctx.arc(centX, centY, 5, 0, Math.PI * 2);\n      ctx.fillStyle = \"#f0f\";\n      ctx.fill();\n      ctx.strokeStyle = \"#fff\";\n      ctx.lineWidth = 1;\n      ctx.stroke();\n    }\n\n    // --- Text area below video ---\n    let textY = vidY + videoH + pad;\n    ctx.textAlign = \"left\";\n    ctx.textBaseline = \"top\";\n    ctx.font = `${fontSize}px 'Orbitron', sans-serif`;\n\n    // Mode + confidence\n    const mode = info ? info.inputMode : \"none\";\n    const confStr = info && info.detected\n      ? `${Math.round(info.confidence * 100)}%`\n      : \"--\";\n    ctx.fillStyle = \"#888\";\n    ctx.fillText(`Mode: ${mode}  Conf: ${confStr}`, panelX + pad, textY);\n    textY += lineH;\n\n    // Distance hint\n    if (info && info.landmarks) {\n      const hint = this._getDistanceHint(info.landmarks);\n      ctx.fillStyle = hint.color;\n      ctx.fillText(`Distance: ${hint.label}`, panelX + pad, textY);\n    } else {\n      ctx.fillStyle = \"#555\";\n      ctx.fillText(\"Show hand to camera\", panelX + pad, textY);\n    }\n    textY += lineH;\n\n    // Cursor position\n    if (info) {\n      ctx.fillStyle = \"#666\";\n      ctx.fillText(\n        `Pos: (${info.cursorSmoothed.x.toFixed(3)}, ${info.cursorSmoothed.y.toFixed(3)})`,\n        panelX + pad, textY,\n      );\n    }\n    textY += lineH;\n\n    // Close hint\n    ctx.fillStyle = \"#444\";\n    ctx.fillText(\"Press D to close\", panelX + pad, textY);\n\n    ctx.restore();\n  }\n\n  /** Evaluate hand distance from camera based on landmark spread. */\n  private _getDistanceHint(landmarks: { x: number; y: number; z: number }[]): { label: string; color: string } {\n    // Use distance between wrist (0) and middle finger MCP (9) as proxy\n    const wrist = landmarks[0];\n    const midMcp = landmarks[9];\n    const dx = wrist.x - midMcp.x;\n    const dy = wrist.y - midMcp.y;\n    const span = Math.sqrt(dx * dx + dy * dy);\n\n    if (span < 0.06) {\n      return { label: \"TOO FAR -- move closer\", color: \"#f44\" };\n    } else if (span > 0.18) {\n      return { label: \"TOO CLOSE -- move back\", color: \"#ff0\" };\n    } else {\n      return { label: \"GOOD\", color: \"#0f0\" };\n    }\n  }\n}\n", "// --- Error capture (sends browser errors to dev server for logging) ---\nfunction reportError(entry: Record<string, unknown>): void {\n  const payload = JSON.stringify({\n    ...entry,\n    timestamp: new Date().toISOString(),\n    userAgent: navigator.userAgent,\n    url: location.href,\n  });\n  fetch(\"/api/errors\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: payload,\n  }).catch(() => { /* server may be down, ignore */ });\n}\n\nwindow.addEventListener(\"error\", (e: ErrorEvent) => {\n  reportError({\n    type: \"onerror\",\n    message: e.message,\n    source: e.filename,\n    lineno: e.lineno,\n    colno: e.colno,\n    stack: e.error?.stack,\n  });\n});\n\nwindow.addEventListener(\"unhandledrejection\", (e) => {\n  const reason = e.reason;\n  reportError({\n    type: \"unhandledrejection\",\n    message: reason?.message ?? String(reason),\n    stack: reason?.stack,\n  });\n});\n\nconst _origConsoleError = console.error;\nconsole.error = (...args: unknown[]) => {\n  _origConsoleError.apply(console, args);\n  // Suppress known non-critical errors from flooding the error log\n  const msg = args.map((a) => (typeof a === \"object\" ? JSON.stringify(a) : String(a))).join(\" \");\n  if (msg.includes(\"Failed to acquire camera feed\")) return;\n  reportError({ type: \"console.error\", message: msg });\n};\n\n// --- Game imports ---\ndeclare const __BUILD_TIMESTAMP__: string;\n\nimport { Game } from \"../game/game.ts\";\nimport { generateBeatmap } from \"../game/beatmap.ts\";\nimport type { Beatmap } from \"../game/types.ts\";\nimport { AudioManager } from \"./audio.ts\";\nimport { InputManager } from \"./input.ts\";\nimport { Renderer } from \"./renderer.ts\";\n\nconst BEATMAP_URL = \"media/ep4.beatmap.json\";\nconst MUSIC_URL = \"media/ep4.mp3\";\n\n/** Request fullscreen and lock to landscape (best-effort, silently ignored if unsupported). */\nfunction requestFullscreenLandscape(): void {\n  const doc = document.documentElement;\n  if (!document.fullscreenElement) {\n    const p = doc.requestFullscreen?.() ?? (doc as unknown as { webkitRequestFullscreen?: () => Promise<void> }).webkitRequestFullscreen?.();\n    if (p instanceof Promise) {\n      p.then(() => {\n        // deno-lint-ignore no-explicit-any\n        (screen.orientation as any)?.lock?.(\"landscape\").catch(() => { /* unsupported on iOS */ });\n      }).catch(() => { /* user denied or unsupported */ });\n    }\n  }\n}\n\nconst canvas = document.getElementById(\"game\") as HTMLCanvasElement;\nconst hudCanvas = document.getElementById(\"hud\") as HTMLCanvasElement;\nconst video = document.getElementById(\"cam\") as HTMLVideoElement;\n\nconst audio = new AudioManager();\nconst input = new InputManager(canvas);\nconst renderer = new Renderer(canvas, hudCanvas, video);\nrenderer.buildTimestamp = typeof __BUILD_TIMESTAMP__ !== \"undefined\" ? __BUILD_TIMESTAMP__ : \"dev\";\n\nlet loadedBeatmap: Beatmap | null = null;\nlet game = new Game(generateBeatmap());\nlet musicMode = false;\nlet musicStarted = false;\n\nlet lastTime = 0;\n\nfunction loop(now: number): void {\n  const dt = lastTime ? Math.min((now - lastTime) / 1000, 0.1) : 1 / 60;\n  lastTime = now;\n\n  input.update(dt);\n\n  if (game.phase === \"playing\" || game.phase === \"countdown\") {\n    if (musicMode && game.phase === \"playing\" && !musicStarted) {\n      // Countdown just finished \u2014 start the music now so music time\n      // and game time both begin from 0 together.\n      audio.startMusic();\n      musicStarted = true;\n    }\n    game.update(now / 1000, dt, input.cursor, audio);\n  }\n\n  // Stop music when game ends\n  if (musicMode && (game.phase === \"results\" || game.phase === \"gameover\")) {\n    audio.stopMusic();\n    musicStarted = false;\n  }\n\n  renderer.render(game, input.cursor, audio.musicMuted, input.debugInfo);\n  requestAnimationFrame(loop);\n}\n\nasync function loadBeatmapAndMusic(): Promise<void> {\n  try {\n    const resp = await fetch(BEATMAP_URL);\n    if (resp.ok) {\n      loadedBeatmap = await resp.json() as Beatmap;\n      await audio.loadMusic(MUSIC_URL);\n      console.log(`Loaded beatmap: ${loadedBeatmap.events.length} events, ${loadedBeatmap.duration.toFixed(0)}s`);\n    }\n  } catch (e) {\n    console.log(\"No beatmap/music found, using procedural generation\", e);\n    loadedBeatmap = null;\n  }\n}\n\nasync function handleStart(): Promise<void> {\n  await audio.init();\n\n  // Recenter gyro so current phone orientation = screen center\n  input.recenter();\n\n  if (loadedBeatmap) {\n    game = new Game(loadedBeatmap);\n    musicMode = true;\n    musicStarted = false;\n  } else {\n    game = new Game(generateBeatmap());\n    musicMode = false;\n    musicStarted = false;\n  }\n  game.start(performance.now() / 1000);\n}\n\nfunction hitTestMuteButton(clientX: number, clientY: number): boolean {\n  const r = renderer.muteButtonRect;\n  // Expand hit area for easier tapping\n  const margin = 10;\n  return (\n    clientX >= r.x - margin && clientX <= r.x + r.w + margin &&\n    clientY >= r.y - margin && clientY <= r.y + r.h + margin\n  );\n}\n\nfunction handleClick(e: MouseEvent | Touch): void {\n  // Enter fullscreen + landscape on any user tap\n  requestFullscreenLandscape();\n\n  // Check mute button first (only during playing)\n  if (game.phase === \"playing\" && hitTestMuteButton(e.clientX, e.clientY)) {\n    audio.toggleMusicMute();\n    return;\n  }\n\n  if (game.phase === \"menu\" || game.phase === \"results\" || game.phase === \"gameover\") {\n    handleStart();\n  }\n}\n\ncanvas.addEventListener(\"click\", (e) => handleClick(e));\ncanvas.addEventListener(\"touchend\", (e) => {\n  e.preventDefault();\n  if (e.changedTouches.length > 0) {\n    handleClick(e.changedTouches[0]);\n  }\n}, { passive: false });\n\n// Draw initial menu state\nrenderer.render(game, input.cursor);\n\n// Pre-load beatmap and music (falls back to procedural if unavailable)\nloadBeatmapAndMusic();\n\n// Init input (attempts hand tracking, falls back to mouse/touch)\ninput.init().then((mode) => {\n  console.log(`Input mode: ${mode}`);\n});\n\n// --- Test harness (exposes internals for Playwright visual tests) ---\n// deno-lint-ignore no-explicit-any\n(window as any).__OPAD_TEST__ = {\n  getGame: () => game,\n  getRenderer: () => renderer,\n  getAudio: () => audio,\n  /** Replace game with a new instance using a custom beatmap and render one frame. */\n  setGame: (beatmap: Beatmap) => {\n    game = new Game(beatmap);\n    renderer.render(game, input.cursor);\n  },\n  /** Start the current game (transitions from menu to countdown). */\n  startGame: () => {\n    game.start(performance.now() / 1000);\n  },\n  /** Tick the game forward by dt seconds and render. */\n  tickAndRender: (dt: number, cursorX = 0.5, cursorY = 0.5) => {\n    const nullAudio = { playTick() {}, playHit() {}, playMiss() {}, playDamage() {}, playCombo() {} };\n    const cursor = { x: cursorX, y: cursorY };\n    game.tick(dt, cursor, nullAudio);\n    renderer.render(game, cursor);\n  },\n  /** Render current state without advancing time. */\n  renderFrame: (cursorX = 0.5, cursorY = 0.5) => {\n    renderer.render(game, { x: cursorX, y: cursorY });\n  },\n};\n\n// Toggle debug overlay with D key\nwindow.addEventListener(\"keydown\", (e: KeyboardEvent) => {\n  if (e.key === \"d\" || e.key === \"D\") {\n    renderer.toggleDebug();\n  }\n});\n\n// Start render loop\nrequestAnimationFrame(loop);\n"],
  "mappings": "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",
  "names": ["clamp"]
}
